(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;a=window.WebSharper=window.WebSharper||{};b=a.UI=a.UI||{};c=b.Next=b.Next||{};d=c.CSharp=c.CSharp||{};e=d.ViewExtensions=d.ViewExtensions||{};f=d.DocExtension=d.DocExtension||{};g=d.Client=d.Client||{};h=g.Helpers=g.Helpers||{};i=g.RouteMapBuilder=g.RouteMapBuilder||{};j=g.RouteItemParsers=g.RouteItemParsers||{};k=c&&c.View;l=c&&c.Doc;m=c&&c.Var;n=a&&a.List;o=window.IntelliFactory;p=o&&o.Runtime;q=c&&c.RouteMap;r=a&&a.Seq;s=a&&a.Unchecked;t=a&&a.Arrays;u=a&&a.Collections;v=u&&u.FSharpMap;w=a&&a.Option;x=u&&u.Map;y=a&&a.Nullable;z=a&&a.Operators;e.UpdateWhile=function(A,B,C){return k.UpdateWhile(B,C,A);};f.DocSeqCached=function(A,B,C){return l.ConvertSeqBy(B,function(D){return function(E){return C(D,E);};},A);};h.seqRefToListRef=function(A){return m.Lens(A,n.ofSeq,function(B,C){return C;});};i=g.RouteMapBuilder=p.Class({Install:function(){var A,B,C;A=q.Install(this.ToRouteMap());B=(C=function(D,E){return D(function(F){return m.Set(A,F);},E);},n.map(function(D){return function(E){return C(D,E);};},n.rev(this.renders)));return l.BindView(function(D){return r.pick(function(E){return E(D);},B);},A.v);},ToRouteMap:function(){var A,B;A=n.rev(this.links);B=n.rev(this.routes);return q.CreateWithQuery(function(C){return r.pick(function(D){return D(C);},A);},function(C){return r.pick(function(D){return D(C);},B);});},AddRender:function(A){this.renders=new n.T({$:1,$0:A,$1:this.renders});},AddLink:function(A){this.links=new n.T({$:1,$0:A,$1:this.links});},AddRoute:function(A){this.routes=new n.T({$:1,$0:A,$1:this.routes});}},null,i);i.New=p.Ctor(function(){this.links=n.T.Empty;this.routes=n.T.Empty;this.renders=n.T.Empty;},i);j["System.Double"]=function(A){var B,C;B=A[0];return B.$==1?(C=(new window.RegExp("^[0-9](?:\\.[0-9]*)?$")).exec(B.$0),s.Equals(C,null)?null:{$:1,$0:[window.parseFloat(t.get(C,0)),B.$1]}):null;};j["System.Int32"]=function(A){var B,C;B=A[0];return B.$==1?(C=(new window.RegExp("^[0-9]+$")).exec(B.$0),s.Equals(C,null)?null:{$:1,$0:[window.parseInt(t.get(C,0),window.$1),B.$1]}):null;};j["System.String"]=function(A){var B;B=A[0];return B.$==1?{$:1,$0:[B.$0,B.$1]}:null;};j.MakeLink=function(A){return function(B){var C,D,E,F,G;return A.$==1?(C=[new v.New([])],[n.append(w.toList(A.$1),n.ofSeq((D=function(H,I,J,K){var L,M,N,O,P,Q;return s.Equals(I,0)?(L=K(B[H]),(C[0]=x.FoldBack(function(R,S,T){return T.Add(R,S);},L[1],C[0]),L[0])):s.Equals(I,1)?(C[0]=(M=n.head((K(B[H]))[0]),C[0].Add(H,M)),n.T.Empty):s.Equals(I,2)?(N=B[H],N!=null&&N.$==1?C[0]=(O=n.head((K(N.$0))[0]),C[0].Add(H,O)):void 0,n.T.Empty):s.Equals(I,3)?(P=B[H],(P!=null?C[0]=(Q=n.head((K(y.get(P)))[0]),C[0].Add(H,Q)):void 0,n.T.Empty)):z.FailWith("invalid QueryItem enum value");},r.collect(function(H){return D(H[0],H[1],H[2],H[3]);},A.$2)))),C[0]]):A.$==2?[new n.T({$:1,$0:window.String(r.length(B)),$1:n.ofSeq(r.collect((E=A.$2,(F=function(H){return H[0];},function(H){return F(E(H));})),B))}),new v.New([])]:A.$==3?[n.ofSeq(r.concat(((G=function(H,I){return function(J){return(I(J))[0];};},(p.Curried3(r.map2))(function(H,I){return(function(J){return G(J[0],J[1]);}(H))(I);}))(A.$0))(B))),new v.New([])]:[n.ofArray([window.String(B)]),new v.New([])];};};j.ParseRoute=function(A){var B,C,D;B=j.ParseShape(A);C=(D=function(E,F){return F.$==0?{$:1,$0:E}:null;},function(E){return E==null?null:D.apply(null,E.$0);});return function(E){return C(B(E));};};j.ParseShape=function(A){return function(B){var C,D,E,F,G,H,I,J,K,L,M,N;function O(P,Q,R){var S,T,U;S=P();T=((U=function(V,W){var X,Y,Z,_0,_1,_2,_3,_4,_5,_6;X=W[0];Y=W[1];Z=W[2];return V!=null&&V.$==1?(_0=V.$0,s.Equals(Y,0)?(_1=Z([_0,D]),_1!=null&&_1.$==1?(S[X]=_1.$0[0],{$:1,$0:_1.$0[1]}):null):s.Equals(Y,1)?(_2=x.TryFind(X,D),_2==null?null:(S[X]=_2.$0,{$:1,$0:_0})):s.Equals(Y,2)?(_3=x.TryFind(X,D),_3!=null&&_3.$==1?(_4=Z([n.ofArray([_3.$0]),new v.New([])]),_4!=null&&_4.$==1?(S[X]={$:1,$0:_4.$0[0]},{$:1,$0:_0}):null):(S[X]=null,{$:1,$0:_0})):s.Equals(Y,3)?(_5=x.TryFind(X,D),_5!=null&&_5.$==1?(_6=Z([n.ofArray([_5.$0]),new v.New([])]),_6!=null&&_6.$==1?(S[X]=_6.$0[0],{$:1,$0:_0}):null):(S[X]=null,{$:1,$0:_0})):z.FailWith("invalid QueryItem enum value")):null;},(p.Curried3(t.fold))(U))({$:1,$0:Q}))(R);return T==null?null:{$:1,$0:[S,T.$0]};}C=B[0];D=B[1];return A.$==1?A.$1==null?O(A.$0,C,A.$2):C.$==1&&(C.$0===A.$1.$0&&(E=[C.$1,C.$0],true))?O(A.$0,E[0],A.$2):null:A.$==2?(F=A.$0,(G=A.$1,(H=j["System.Int32"]([C,D]),H==null?null:(I=H.$0[0],(J=H.$0[1],(K=t.create(I,null),function(P,Q){var R;while(true)if(P===I)return{$:1,$0:[F(K),Q]};else{R=G([Q,D]);if(R!=null&&R.$==1){t.set(K,P,R.$0[0]);P=P+1;Q=R.$0[1];}else return null;}}(0,J))))))):A.$==3?(L=[],(M=((N=function(P,Q){var R,S,T;return P==null?null:(R=Q[0]([P.$0,D]),R==null?null:{$:1,$0:(S=R.$0[0],(T=R.$0[1],(L.push(S),T)))});},(p.Curried3(t.fold))(N))({$:1,$0:C}))(A.$0),M==null?null:{$:1,$0:[L,M.$0]})):A.$0([C,D]);};};}());
