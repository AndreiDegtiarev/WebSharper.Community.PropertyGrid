(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY;a=window;b=a.WebSharper=a.WebSharper||{};c=b.UI=b.UI||{};d=c.Array=c.Array||{};e=c.String=c.String||{};f=c.List=c.List||{};g=c.Abbrev=c.Abbrev||{};h=g.Fresh=g.Fresh||{};i=g.HashSet=g.HashSet||{};j=g.Dict=g.Dict||{};k=b&&b.Obj;l=g.Slot=g.Slot||{};m=g.Async=g.Async||{};n=g.Mailbox=g.Mailbox||{};o=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};p=c.AppendList=c.AppendList||{};q=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};r=c.DomUtility=c.DomUtility||{};s=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};t=c.Trie=c.Trie||{};u=t.LookupResult=t.LookupResult||{};v=a.StartupCode$WebSharper_UI$Trie=a.StartupCode$WebSharper_UI$Trie||{};w=c.Snap=c.Snap||{};x=c.Var=c.Var||{};y=c.View=c.View||{};z=c.ConcreteVar=c.ConcreteVar||{};A=c.Updates=c.Updates||{};B=c.FromView=c.FromView||{};C=c.ViewBuilder=c.ViewBuilder||{};D=c.Submitter=c.Submitter||{};E=c.Key=c.Key||{};F=c.Model=c.Model||{};G=c.Serializer=c.Serializer||{};H=c.Storage=c.Storage||{};I=H.ArrayStorage=H.ArrayStorage||{};J=H.LocalStorageBackend=H.LocalStorageBackend||{};K=c.ListModel=c.ListModel||{};L=c.ListModels=c.ListModels||{};M=a.StartupCode$WebSharper_UI$Models=a.StartupCode$WebSharper_UI$Models||{};N=c.ReactiveExtensions=c.ReactiveExtensions||{};O=c.DoubleInterpolation=c.DoubleInterpolation||{};P=c.Interpolation=c.Interpolation||{};Q=c.Easing=c.Easing||{};R=c.Easings=c.Easings||{};S=c.An=c.An||{};T=c.Anims=c.Anims||{};U=c.Trans=c.Trans||{};V=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};W=b&&b.Web;X=W&&W.Control;Y=c.OnAfterRenderControl=c.OnAfterRenderControl||{};Z=c.AnimatedAttrNode=c.AnimatedAttrNode||{};_0=c.DynamicAttrNode=c.DynamicAttrNode||{};_1=c.AttrProxy=c.AttrProxy||{};_2=c.Client=c.Client||{};_3=_2.Attrs=_2.Attrs||{};_4=_3.Dyn=_3.Dyn||{};_5=c.Attrs=c.Attrs||{};_6=c.CheckedInput=c.CheckedInput||{};_7=c.AttrModule=c.AttrModule||{};_8=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};_9=_2.Settings=_2.Settings||{};_=c.DocElemNode=c.DocElemNode||{};$=_2.Docs=_2.Docs||{};ba=$.DomNodes=$.DomNodes||{};bb=$.NodeSet=$.NodeSet||{};bc=$.RunState=$.RunState||{};bd=c.Docs=c.Docs||{};be=c.Doc=c.Doc||{};bf=c.Elt=c.Elt||{};bg=_2.EltUpdater=_2.EltUpdater||{};bh=a.StartupCode$WebSharper_UI$Doc_Client=a.StartupCode$WebSharper_UI$Doc_Client||{};bi=c.Flow=c.Flow||{};bj=c.FlowBuilder=c.FlowBuilder||{};bk=c.HtmlModule=c.HtmlModule||{};bl=bk.attr=bk.attr||{};bm=c.Router=c.Router||{};bn=c.Route=c.Route||{};bo=c.Routing=c.Routing||{};bp=c.RouteMap=c.RouteMap||{};bq=c.Input=c.Input||{};br=bq.MousePosSt=bq.MousePosSt||{};bs=bq.MouseBtnSt=bq.MouseBtnSt||{};bt=bq.Mouse=bq.Mouse||{};bu=bq.KeyListenerSt=bq.KeyListenerSt||{};bv=bq.Keyboard=bq.Keyboard||{};bw=a.StartupCode$WebSharper_UI$Input=a.StartupCode$WebSharper_UI$Input||{};bx=b&&b.List;by=b&&b.Arrays;bz=b&&b.Enumerator;bA=b&&b.Strings;bB=b&&b.Char;bC=b&&b.Collections;bD=bC&&bC.HashSet;bE=b&&b.Seq;bF=a.IntelliFactory;bG=bF&&bF.Runtime;bH=b&&b.Unchecked;bI=a.console;bJ=b&&b.Concurrency;bK=bC&&bC.Map;bL=bC&&bC.FSharpMap;bM=b&&b.Operators;bN=b&&b.Queue;bO=b&&b.Lazy;bP=bC&&bC.Dictionary;bQ=a.JSON;bR=b&&b.Numeric;bS=a.Node;bT=a.jQuery;bU=b&&b.Slice;bV=b&&b.Sitelets;bW=bV&&bV.RouterModule;bX=bV&&bV.Route;bY=b&&b.Utils;d.mapInPlace=function(bZ,b0){var b1,b2;for(b1=0,b2=b0.length-1;b1<=b2;b1++)b0[b1]=bZ(b0[b1]);return b0;};d.ofSeqNonCopying=function(bZ){var b0,b1;if(bZ instanceof a.Array)return bZ;else if(bZ instanceof bx.T)return by.ofList(bZ);else if(bZ===null)return[];else{b0=[];b1=bz.Get(bZ);try{while(b1.MoveNext())b0.push(b1.Current());return b0;}finally{if("Dispose"in b1)b1.Dispose();}}};d.MapTreeReduce=function(bZ,b0,b1,b2){var b3;function b4(b5,b6){var b7,b8;return b6<=0?b0:b6===1&&(b5>=0&&b5<b3)?bZ(by.get(b2,b5)):(b8=b6/2>>0,b1(b4(b5,b8),b4(b5+b8,b6-b8)));}b3=by.length(b2);return b4(0,b3);};d.TreeReduce=function(bZ,b0,b1){var b2;function b3(b4,b5){var b6,b7;return b5<=0?bZ:b5===1&&(b4>=0&&b4<b2)?by.get(b1,b4):(b7=b5/2>>0,b0(b3(b4,b7),b3(b4+b7,b5-b7)));}b2=by.length(b1);return b3(0,b2);};e.isBlank=function(bZ){return bA.forall(bB.IsWhiteSpace,bZ);};f.maybeReplaceFirst=function(bZ,b0,b1){var b2;b2=[false];return bx.map(function(b3){var b4;return!b2[0]&&bZ(b3)?(b4=b0(b3),b4==null?b3:b4.$0):b3;},b1);};f.replaceFirst=function(bZ,b0,b1){var b2;b2=[false];return bx.map(function(b3){return!b2[0]&&bZ(b3)?b0(b3):b3;},b1);};h.Id=function(){h.set_counter(h.counter()+1);return"uid"+a.String(h.counter());};h.Int=function(){h.set_counter(h.counter()+1);return h.counter();};h.counter=function(){o.$cctor();return o.counter;};h.set_counter=function(bZ){o.$cctor();o.counter=bZ;};i.Filter=function(bZ,b0){return new bD.New$2(by.filter(bZ,i.ToArray(b0)));};i.Intersect=function(bZ,b0){var b1;b1=new bD.New$2(i.ToArray(bZ));b1.IntersectWith(i.ToArray(b0));return b1;};i.Except=function(bZ,b0){var b1;b1=new bD.New$2(i.ToArray(b0));b1.ExceptWith(i.ToArray(bZ));return b1;};i.ToArray=function(bZ){var b0;b0=by.create(bZ.get_Count(),void 0);bZ.CopyTo(b0);return b0;};j.ToValueArray=function(bZ){var b0;b0=by.create(bZ.count,void 0);bE.iteri(function(b1,b2){return by.set(b0,b1,b2.V);},bZ);return b0;};j.ToKeyArray=function(bZ){var b0;b0=by.create(bZ.count,void 0);bE.iteri(function(b1,b2){return by.set(b0,b1,b2.K);},bZ);return b0;};l=g.Slot=bG.Class({GetHashCode:function(){return bH.Hash(this.key(this.value));},Equals:function(bZ){return bH.Equals(this.key(this.value),this.key(bZ.get_Value()));},get_Value:function(){return this.value;}},k,l);l.New=bG.Ctor(function(bZ,b0){this.key=bZ;this.value=b0;},l);l.Create=function(bZ,b0){return new l.New(bZ,b0);};m.OnError=function(bZ){return bI.log("WebSharper UI: Uncaught asynchronous exception",bZ);};m.StartTo=function(bZ,b0){bJ.StartWithContinuations(bZ,b0,function(b1){m.OnError(b1);},a.ignore,null);};n.StartProcessor=function(bZ){var b0;function b1(){var b2;b2=null;return bJ.Delay(function(){return bJ.Bind(bZ,function(){var b3;b3=b0[0];return b3===1?(b0[0]=0,bJ.Zero()):b3===2?(b0[0]=1,b1()):bJ.Zero();});});}b0=[0];return function(){var b2;b2=b0[0];b2===0?(b0[0]=1,bJ.Start(b1(),null)):b2===1?b0[0]=2:void 0;};};o.$cctor=function(){o.$cctor=a.ignore;o.counter=0;};p.FromArray=function(bZ){var b0;b0=bZ.length;return b0===0?{$:0}:b0===1?{$:1,$0:by.get(bZ,0)}:{$:3,$0:bZ.slice()};};p.ToArray=function(bZ){var b0;function b1(b2){if(b2.$==1)b0.push(b2.$0);else if(b2.$==2){b1(b2.$0);b1(b2.$1);}else if(b2.$==3)by.iter(function(b3){b0.push(b3);},b2.$0);}b0=[];b1(bZ);return b0.slice(0);};p.Single=function(bZ){return{$:1,$0:bZ};};p.Concat=function(bZ){var b0;b0=d.ofSeqNonCopying(bZ);return d.TreeReduce(p.Empty(),p.Append,b0);};p.Append=function(bZ,b0){return bZ.$==0?b0:b0.$==0?bZ:{$:2,$0:bZ,$1:b0};};p.Empty=function(){q.$cctor();return q.Empty;};q.$cctor=function(){q.$cctor=a.ignore;q.Empty={$:0};};r.SetProperty=function(bZ,b0,b1){return bZ.setProperty(b0,b1);};r.IterSelector=function(bZ,b0,b1){var b2,b3,b4;b2=bZ.querySelectorAll(b0);for(b3=0,b4=b2.length-1;b3<=b4;b3++)b1(b2[b3]);};r.ChildrenArray=function(bZ){var b0,b1,b2;b0=[];for(b1=0,b2=bZ.childNodes.length-1;b1<=b2;b1++)b0.push(bZ.childNodes[b1]);return b0;};r.RemoveClass=function(bZ,b0){a.jQuery(bZ).removeClass(b0);};r.AddClass=function(bZ,b0){a.jQuery(bZ).addClass(b0);};r.InsertAt=function(bZ,b0,b1){var b2;if(!(b1.parentNode===bZ&&b0===(b2=b1.nextSibling,bH.Equals(b2,null)?null:b2)))bZ.insertBefore(b1,b0);};r.RemoveNode=function(bZ,b0){if(b0.parentNode===bZ)bZ.removeChild(b0);};r.SetStyle=function(bZ,b0,b1){r.SetProperty(bZ.style,b0,b1);};r.SetAttr=function(bZ,b0,b1){bZ.setAttribute(b0,b1);};r.RemoveAttr=function(bZ,b0){bZ.removeAttribute(b0);};r.CreateAttr=function(bZ,b0){var b1;b1=r.Doc().createAttribute(bZ);b1.value=b0;return b1;};r.CreateText=function(bZ){return r.Doc().createTextNode(bZ);};r.CreateSvgElement=function(bZ){return r.Doc().createElementNS("http://www.w3.org/2000/svg",bZ);};r.CreateElement=function(bZ){return r.Doc().createElement(bZ);};r.Clear=function(bZ){while(bZ.hasChildNodes())bZ.removeChild(bZ.firstChild);};r.ClearAttrs=function(bZ){while(bZ.hasAttributes())bZ.removeAttributeNode(bZ.attributes.item(0));};r.AppendTo=function(bZ,b0){bZ.appendChild(b0);};r.Doc=function(){s.$cctor();return s.Doc;};s.$cctor=function(){s.$cctor=a.ignore;s.Doc=a.document;};u.NotFound={$:1};t.Empty=function(){v.$cctor();return v.Empty;};t.Lookup=function(bZ,b0){return t.Look(bx.ofSeq(b0),bZ);};t.Look=function(bZ,b0){var b1,b2;switch(b0.$==2?(b1=b0.$0,0):b0.$==0?bZ.$==1?(b1=[bZ.$0,bZ.$1,b0.$0],1):2:2){case 0:return{$:0,$0:b1,$1:bZ};break;case 1:b2=bK.TryFind(b1[0],b1[2]);return b2==null?u.NotFound:t.Look(b1[1],b2.$0);break;case 2:return u.NotFound;break;}};t.ToArray=function(bZ){var b0;b0=[];t.Map(function(){return function(b1){return b0.push(b1);};},bZ);return b0.slice(0);};t.Mapi=function(bZ,b0){var b1;function b2(){var b3;b3=b1[0];b1[0]=b3+1;return b3;}b1=[0];return t.Map(function(b3){return bZ(b2(),b3);},b0);};t.Map=function(bZ,b0){return t.MapLoop(bx.T.Empty,bZ,b0);};t.MapLoop=function(bZ,b0,b1){return b1.$==1?{$:1}:b1.$==2?{$:2,$0:(b0(bZ))(b1.$0)}:t.TrieBranch(bK.Map(function(b2,b3){return t.MapLoop(bx.append(bZ,bx.ofArray([b2])),b0,b3);},b1.$0));};t.Merge=function(bZ){var b0,b1,b2;b0=d.ofSeqNonCopying(bZ);b1=by.length(b0);return b1===0?{$:1,$0:{$:1}}:b1===1?{$:1,$0:by.get(b0,0)}:by.exists(t.IsLeaf,b0)?null:(b2=t.MergeMaps(t.Merge,bE.choose(function(b3){return b3.$==0?{$:1,$0:b3.$0}:null;},b0)),b2==null?null:{$:1,$0:t.TrieBranch(b2.$0)});};t.IsLeaf=function(bZ){return bZ.$==2;};t.MergeMaps=function(bZ,b0){var b1,b2;function b3(b4,b5){var b6;b6=bZ(b5);return b6==null?null:{$:1,$0:[b4,b6.$0]};}b1=t.AllSome(bE.map(function(b4){return b3(b4[0],b4[1]);},bK.ToSeq((b2=bE.collect(bK.ToSeq,b0),bE.fold(function(b4,b5){return t.MultiAdd(b5[0],b5[1],b4);},new bL.New([]),b2)))));return b1==null?null:{$:1,$0:bK.OfArray(by.ofSeq(b1.$0))};};t.AllSome=function(bZ){var b0,b1,b2,b3;b1=bz.Get(bZ);b2=[];b0=true;while(b0&&b1.MoveNext()){b3=b1.Current();b3!=null&&b3.$==1?b2.push(b3.$0):b0=false;}return b0?{$:1,$0:b2.slice()}:null;};t.MultiAdd=function(bZ,b0,b1){return b1.Add(bZ,new bx.T({$:1,$0:b0,$1:t.MultiFind(bZ,b1)}));};t.MultiFind=function(bZ,b0){var b1;b1=bK.TryFind(bZ,b0);return b1==null?bx.T.Empty:b1.$0;};t.Prefix=function(bZ,b0){return t.TrieBranch(new bL.New(bx.ofArray([[bZ,b0]])));};t.Leaf=function(bZ){return{$:2,$0:bZ};};t.TrieBranch=function(bZ){return bZ.get_IsEmpty()?{$:1}:{$:0,$0:bZ};};v.$cctor=function(){v.$cctor=a.ignore;v.Empty={$:1};};w.Obsolete=function(bZ){var b0,b1,b2,b3,b4;b1=bZ.s;if(b1==null||(b1!=null&&b1.$==2?(b0=b1.$1,false):b1!=null&&b1.$==3?(b0=b1.$1,false):true))void 0;else{bZ.s=null;for(b2=0,b3=by.length(b0)-1;b2<=b3;b2++){b4=by.get(b0,b2);typeof b4=="object"?function(b5){w.Obsolete(b5);}(b4):b4();}}};w.New=function(bZ){return{s:bZ};};w.MapAsync=function(bZ,b0){var b1;b1=w.New({$:3,$0:[],$1:[]});w.When(b0,function(b2){m.StartTo(bZ(b2),function(b3){w.MarkDone(b1,b0,b3);});},b1);return b1;};w.SnapshotOn=function(bZ,b0){var b1;function b2(b3){var b4,b5,b6;if(!(b4=b1.s,b4!=null&&b4.$==0||b4!=null&&b4.$==2)){b5=w.ValueAndForever(bZ);b6=w.ValueAndForever(b0);b5!=null&&b5.$==1?b6!=null&&b6.$==1?b5.$0[1]||b6.$0[1]?w.MarkForever(b1,b6.$0[0]):w.MarkReady(b1,b6.$0[0]):void 0:void 0;}}b1=w.New({$:3,$0:[],$1:[]});w.When(bZ,b2,b1);w.WhenReady(b0,b2);return b1;};w.Map3=function(bZ,b0,b1,b2){var b3,b4,b5,b6;function b7(b8){var b9,b_,b$,ca;if(!(b9=b6.s,b9!=null&&b9.$==0||b9!=null&&b9.$==2)){b_=w.ValueAndForever(b0);b$=w.ValueAndForever(b1);ca=w.ValueAndForever(b2);b_!=null&&b_.$==1?b$!=null&&b$.$==1?ca!=null&&ca.$==1?b_.$0[1]&&b$.$0[1]&&ca.$0[1]?w.MarkForever(b6,bZ(b_.$0[0],b$.$0[0],ca.$0[0])):w.MarkReady(b6,bZ(b_.$0[0],b$.$0[0],ca.$0[0])):void 0:void 0:void 0;}}b3=b0.s;b4=b1.s;b5=b2.s;return b3!=null&&b3.$==0?b4!=null&&b4.$==0?b5!=null&&b5.$==0?w.New({$:0,$0:bZ(b3.$0,b4.$0,b5.$0)}):w.Map3Opt1(bZ,b3.$0,b4.$0,b2):b5!=null&&b5.$==0?w.Map3Opt2(bZ,b3.$0,b5.$0,b1):w.Map3Opt3(bZ,b3.$0,b1,b2):b4!=null&&b4.$==0?b5!=null&&b5.$==0?w.Map3Opt4(bZ,b4.$0,b5.$0,b0):w.Map3Opt5(bZ,b4.$0,b0,b2):b5!=null&&b5.$==0?w.Map3Opt6(bZ,b5.$0,b0,b1):(b6=w.New({$:3,$0:[],$1:[]}),(w.When(b0,b7,b6),w.When(b1,b7,b6),w.When(b2,b7,b6),b6));};w.Map3Opt6=function(bZ,b0,b1,b2){return w.Map2(function(b3,b4){return bZ(b3,b4,b0);},b1,b2);};w.Map3Opt5=function(bZ,b0,b1,b2){return w.Map2(function(b3,b4){return bZ(b3,b0,b4);},b1,b2);};w.Map3Opt4=function(bZ,b0,b1,b2){return w.Map(function(b3){return bZ(b3,b0,b1);},b2);};w.Map3Opt3=function(bZ,b0,b1,b2){return w.Map2(function(b3,b4){return bZ(b0,b3,b4);},b1,b2);};w.Map3Opt2=function(bZ,b0,b1,b2){return w.Map(function(b3){return bZ(b0,b3,b1);},b2);};w.Map3Opt1=function(bZ,b0,b1,b2){return w.Map(function(b3){return bZ(b0,b1,b3);},b2);};w.Map2Unit=function(bZ,b0){var b1,b2,b3;function b4(){var b5,b6,b7;if(!(b5=b3.s,b5!=null&&b5.$==0||b5!=null&&b5.$==2)){b6=w.ValueAndForever(bZ);b7=w.ValueAndForever(b0);b6!=null&&b6.$==1?b7!=null&&b7.$==1?b6.$0[1]&&b7.$0[1]?w.MarkForever(b3,null):w.MarkReady(b3,null):void 0:void 0;}}b1=bZ.s;b2=b0.s;return b1!=null&&b1.$==0?b2!=null&&b2.$==0?w.New({$:0,$0:null}):b0:b2!=null&&b2.$==0?bZ:(b3=w.New({$:3,$0:[],$1:[]}),(w.When(bZ,b4,b3),w.When(b0,b4,b3),b3));};w.Map2=function(bZ,b0,b1){var b2,b3,b4;function b5(b6){var b7,b8,b9;if(!(b7=b4.s,b7!=null&&b7.$==0||b7!=null&&b7.$==2)){b8=w.ValueAndForever(b0);b9=w.ValueAndForever(b1);b8!=null&&b8.$==1?b9!=null&&b9.$==1?b8.$0[1]&&b9.$0[1]?w.MarkForever(b4,bZ(b8.$0[0],b9.$0[0])):w.MarkReady(b4,bZ(b8.$0[0],b9.$0[0])):void 0:void 0;}}b2=b0.s;b3=b1.s;return b2!=null&&b2.$==0?b3!=null&&b3.$==0?w.New({$:0,$0:bZ(b2.$0,b3.$0)}):w.Map2Opt1(bZ,b2.$0,b1):b3!=null&&b3.$==0?w.Map2Opt2(bZ,b3.$0,b0):(b4=w.New({$:3,$0:[],$1:[]}),(w.When(b0,b5,b4),w.When(b1,b5,b4),b4));};w.Map2Opt2=function(bZ,b0,b1){return w.Map(function(b2){return bZ(b2,b0);},b1);};w.Map2Opt1=function(bZ,b0,b1){return w.Map(function(b2){return bZ(b0,b2);},b1);};w.MapCachedBy=function(bZ,b0,b1,b2){return w.Map(function(b3){var b4,b5,b6;b4=b0[0];return b4!=null&&b4.$==1&&(bZ(b3,b4.$0[0])&&(b5=[b4.$0[0],b4.$0[1]],true))?b5[1]:(b6=b1(b3),(b0[0]={$:1,$0:[b3,b6]},b6));},b2);};w.Copy=function(bZ){var b0,b1,b2;b0=bZ.s;return b0==null?bZ:b0!=null&&b0.$==2?(b1=w.New({$:2,$0:b0.$0,$1:[]}),(w.WhenObsolete(bZ,b1),b1)):b0!=null&&b0.$==3?(b2=w.New({$:3,$0:[],$1:[]}),(w.When(bZ,function(b3){w.MarkDone(b2,bZ,b3);},b2),b2)):bZ;};w.WithInitOption=function(bZ){var b0,b1,b2;b0=bZ.s;return b0==null?w.New(null):b0!=null&&b0.$==2?(b1=w.New({$:2,$0:{$:1,$0:b0.$0},$1:[]}),(w.WhenObsolete(bZ,b1),b1)):b0!=null&&b0.$==3?(b2=w.New({$:2,$0:null,$1:[]}),(w.When(bZ,function(){w.Obsolete(b2);},b2),b2)):w.New({$:0,$0:{$:1,$0:b0.$0}});};w.WithInit=function(bZ,b0){var b1,b2,b3;b1=b0.s;return b1==null?b0:b1!=null&&b1.$==2?(b2=w.New({$:2,$0:b1.$0,$1:[]}),(w.WhenObsolete(b0,b2),b2)):b1!=null&&b1.$==3?(b3=w.New({$:2,$0:bZ,$1:[]}),(w.When(b0,function(){w.Obsolete(b3);},b3),b3)):b0;};w.Map=function(bZ,b0){var b1,b2;b1=b0.s;return b1!=null&&b1.$==0?w.New({$:0,$0:bZ(b1.$0)}):(b2=w.New({$:3,$0:[],$1:[]}),(w.When(b0,function(b3){w.MarkDone(b2,b0,bZ(b3));},b2),b2));};w.Sequence=function(bZ){var b0,b1,b2;function b3(b4){var b5;if(b2[0]===0){b5=by.map(function(b6){var b7;b7=b6.s;return b7!=null&&b7.$==0?b7.$0:b7!=null&&b7.$==2?b7.$0:bM.FailWith("value not found by View.Sequence");},b0);by.forall(function(b6){var b7;b7=b6.s;return b7!=null&&b7.$==0;},b0)?w.MarkForever(b1,b5):w.MarkReady(b1,b5);}else b2[0]--;}b0=by.ofSeq(bZ);return b0.length==0?w.New({$:0,$0:[]}):(b1=w.New({$:3,$0:[],$1:[]}),(b2=[by.length(b0)-1],(by.iter(function(b4){w.When(b4,b3,b1);},b0),b1)));};w.CreateForeverAsync=function(bZ){var b0;b0=w.New({$:3,$0:[],$1:[]});m.StartTo(bZ,function(b1){w.MarkForever(b0,b1);});return b0;};w.JoinInner=function(bZ){var b0;b0=w.New({$:3,$0:[],$1:[]});w.When(bZ,function(b1){var b2;b2=b1();w.When(b2,function(b3){var b4,b5;if((b4=b2.s,b4!=null&&b4.$==0)&&(b5=bZ.s,b5!=null&&b5.$==0))w.MarkForever(b0,b3);else w.MarkReady(b0,b3);},b0);w.WhenObsolete(bZ,b2);},b0);return b0;};w.Join=function(bZ){var b0;b0=w.New({$:3,$0:[],$1:[]});w.When(bZ,function(b1){var b2;b2=b1();w.When(b2,function(b3){var b4,b5;if((b4=b2.s,b4!=null&&b4.$==0)&&(b5=bZ.s,b5!=null&&b5.$==0))w.MarkForever(b0,b3);else w.MarkReady(b0,b3);},b0);},b0);return b0;};w.ValueAndForever=function(bZ){var b0;b0=bZ.s;return b0!=null&&b0.$==0?{$:1,$0:[b0.$0,true]}:b0!=null&&b0.$==2?{$:1,$0:[b0.$0,false]}:null;};w.WhenObsoleteRun=function(bZ,b0){var b1;b1=bZ.s;b1==null?b0():b1!=null&&b1.$==2?b1.$1.push(b0):b1!=null&&b1.$==3?b1.$1.push(b0):void 0;};w.WhenObsolete=function(bZ,b0){var b1;b1=bZ.s;b1==null?w.Obsolete(b0):b1!=null&&b1.$==2?w.EnqueueSafe(b1.$1,b0):b1!=null&&b1.$==3?w.EnqueueSafe(b1.$1,b0):void 0;};w.WhenReady=function(bZ,b0){var b1,b2;b2=bZ.s;switch(b2!=null&&b2.$==2?(b1=b2.$0,0):b2==null?1:b2!=null&&b2.$==3?2:(b1=b2.$0,0)){case 0:b0(b1);break;case 1:null;break;case 2:b2.$0.push(b0);break;}};w.WhenRun=function(bZ,b0,b1){var b2;b2=bZ.s;b2==null?b1():b2!=null&&b2.$==2?(b2.$1.push(b1),b0(b2.$0)):b2!=null&&b2.$==3?(b2.$0.push(b0),b2.$1.push(b1)):b0(b2.$0);};w.When=function(bZ,b0,b1){var b2;b2=bZ.s;b2==null?w.Obsolete(b1):b2!=null&&b2.$==2?(w.EnqueueSafe(b2.$1,b1),b0(b2.$0)):b2!=null&&b2.$==3?(b2.$0.push(b0),w.EnqueueSafe(b2.$1,b1)):b0(b2.$0);};w.EnqueueSafe=function(bZ,b0){var b1,b2,b3,b4;bZ.push(b0);if(bZ.length%20===0){b1=bZ.slice(0);bN.Clear(bZ);for(b2=0,b3=by.length(b1)-1;b2<=b3;b2++){b4=by.get(b1,b2);typeof b4=="object"?function(b5){if(b5.s)bZ.push(b5);}(b4):function(b5){bZ.push(b5);}(b4);}}else void 0;};w.MarkDone=function(bZ,b0,b1){var b2;if(b2=b0.s,b2!=null&&b2.$==0)w.MarkForever(bZ,b1);else w.MarkReady(bZ,b1);};w.MarkReady=function(bZ,b0){var b1,b2,b3,b4;b1=bZ.s;if(b1!=null&&b1.$==3){bZ.s={$:2,$0:b0,$1:b1.$1};b2=b1.$0;for(b3=0,b4=by.length(b2)-1;b3<=b4;b3++)(by.get(b2,b3))(b0);}else void 0;};w.MarkForever=function(bZ,b0){var b1,b2,b3,b4;b1=bZ.s;if(b1!=null&&b1.$==3){bZ.s={$:0,$0:b0};b2=b1.$0;for(b3=0,b4=by.length(b2)-1;b3<=b4;b3++)(by.get(b2,b3))(b0);}else void 0;};x=c.Var=bG.Class({},k,x);x.New=bG.Ctor(function(){},x);y=c.View=bG.Class({get_V:function(){return bM.FailWith("View<'T>.V can only be called in an argument to a V-enabled function or if 'T = Doc.");}},null,y);z=c.ConcreteVar=bG.Class({get_Id:function(){return"uinref"+a.String(this.id);},get_View:function(){return this.view;},UpdateMaybe:function(bZ){var b0;b0=bZ(this.Get());b0!=null&&b0.$==1?this.Set(b0.$0):void 0;},Update:function(bZ){this.Set(bZ(this.Get()));},SetFinal:function(bZ){if(this.isConst)(function(b0){return b0("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(b0){bI.log(b0);}));else{w.Obsolete(this.snap);this.isConst=true;this.current=bZ;this.snap=w.New({$:0,$0:bZ});}},Set:function(bZ){if(this.isConst)(function(b0){return b0("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(b0){bI.log(b0);}));else{w.Obsolete(this.snap);this.current=bZ;this.snap=w.New({$:2,$0:bZ,$1:[]});}},Get:function(){return this.current;}},x,z);z.New=bG.Ctor(function(bZ,b0,b1){var b2;b2=this;x.New.call(this);this.isConst=bZ;this.current=b1;this.snap=b0;this.view=function(){return b2.snap;};this.id=h.Int();},z);x.MapLens=function(bZ,b0,b1){return y.MapSeqCachedViewBy(bZ,function(b2,b3){var b4,b5;function b6(b7){return bH.Equals(bZ(b7),b2);}b4=h.Id();return b0((b5=new x({Get:function(){return bE.find(b6,b1.Get());},Set:function(b7){function b8(b9){return b7;}return b1.Update(function(b9){return f.replaceFirst(b6,b8,b9);});},SetFinal:function(b7){return this.Set(b7);},Update:function(b7){return b1.Update(function(b8){return f.replaceFirst(b6,b7,b8);});},UpdateMaybe:function(b7){return b1.Update(function(b8){return f.maybeReplaceFirst(b6,b7,b8);});},get_View:function(){return b3;},get_Id:function(){return b4;}}),(x.New.call(b5),b5)));},b1.get_View());};x.Lens=function(bZ,b0,b1){var b2,b3,b4;b2=h.Id();b3=y.Map(b0,bZ.get_View());b4=new x({Get:function(){return b0(bZ.Get());},Set:function(b5){return bZ.Update(function(b6){return b1(b6,b5);});},SetFinal:function(b5){return this.Set(b5);},Update:function(b5){return bZ.Update(function(b6){return b1(b6,b5(b0(b6)));});},UpdateMaybe:function(b5){return bZ.UpdateMaybe(function(b6){var b7;b7=b5(b0(b6));return b7==null?null:{$:1,$0:b1(b6,b7.$0)};});},get_View:function(){return b3;},get_Id:function(){return b2;}});x.New.call(b4);return b4;};x.Update=function(bZ,b0){x.Set(bZ,b0(bZ.Get()));};x.SetFinal=function(bZ,b0){bZ.SetFinal(b0);};x.Set=function(bZ,b0){bZ.Set(b0);};x.CreateWaiting=function(){return new z.New(false,w.New({$:3,$0:[],$1:[]}),null);};x.Create=function(){return new z.New(false,w.New({$:2,$0:null,$1:[]}),null);};x.CreateLogged=function(bZ,b0){var b1;!window.UINVars?window.UINVars=[]:void 0;b1=x.Create$1(b0);window.UINVars.push([bZ,b1]);return b1;};x.Create$1=function(bZ){return new z.New(false,w.New({$:2,$0:bZ,$1:[]}),bZ);};A=c.Updates=bG.Class({set_Value:function(bZ){var b0;b0=this.s;!(b0===null)?w.Obsolete(b0):void 0;this.c=bZ;}},null,A);A.Create=function(bZ){var b0;b0=null;b0=A.New(bZ,null,function(){var b1;b1=b0.s;return b1===null?(b1=w.Copy(b0.c()),b0.s=b1,w.WhenObsoleteRun(b1,function(){b0.s=null;}),b1):b1;});return b0;};A.New=function(bZ,b0,b1){return new A({c:bZ,s:b0,v:b1});};y.get_Do=function(){return C.B;};y.Apply=function(bZ,b0){return y.Map2(function(b1,b2){return b1(b2);},bZ,b0);};y.AsyncAwait=function(bZ,b0){function b1(b2){var b3,b4;function b5(){return y.RemovableSink(function(b6){if(bZ(b6)){(bO.Force(b3))();b2(b6);}},b0);}b3=bO.Create(b5);b4=bO.Force(b3);}return bJ.FromContinuations(function(b2,b3,b4){return b1.apply(null,[b2,b3,b4]);});};y.RemovableSink=function(bZ,b0){var b1;function b2(){w.WhenRun(b0(),function(b3){if(b1[0])bZ(b3);},function(){if(b1[0])bJ.scheduler().Fork(b2);});}b1=[true];bJ.scheduler().Fork(b2);return function(){b1[0]=false;};};y.Sink=function(bZ,b0){function b1(){w.WhenRun(b0(),bZ,function(){bJ.scheduler().Fork(b1);});}bJ.scheduler().Fork(b1);};y.TryFinally=function(bZ,b0){return y.CreateLazy(function(){try{return b0();}finally{bZ();}});};y.TryWith=function(bZ,b0){return y.CreateLazy(function(){try{return b0();}catch(b1){return(bZ(b1))();}});};y.ConstAsync=function(bZ){var b0;b0=w.CreateForeverAsync(bZ);return function(){return b0;};};y.Const=function(bZ){var b0;b0=w.New({$:0,$0:bZ});return function(){return b0;};};y.Sequence=function(bZ){return y.CreateLazy(function(){return w.Sequence(bE.map(function(b0){return b0();},bZ));});};y.UpdateWhile=function(bZ,b0,b1){var b2;b2=[bZ];return y.BindInner(function(b3){return b3?y.Map(function(b4){b2[0]=b4;return b4;},b1):y.Const(b2[0]);},b0);};y.BindInner=function(bZ,b0){return y.JoinInner(y.Map(bZ,b0));};y.JoinInner=function(bZ){return y.CreateLazy(function(){return w.JoinInner(bZ());});};y.Bind=function(bZ,b0){return y.Join(y.Map(bZ,b0));};y.Join=function(bZ){return y.CreateLazy(function(){return w.Join(bZ());});};y.MapSeqCachedView=function(bZ,b0){function b1(b2){return bZ;}return y.MapSeqCachedViewBy(a.id,function(b2,b3){return(b1(b2))(b3);},b0);};y.MapSeqCachedViewBy=function(bZ,b0,b1){var b2;b2=[new bP.New$5()];return y.Map(function(b3){var b4,b5,b6;b4=b2[0];b5=new bP.New$5();b6=d.mapInPlace(function(b7){var b8,b9,b_;b8=bZ(b7);b9=b4.ContainsKey(b8)?(b_=b4.get_Item(b8),(x.Set(b_.r,b7),b_)):y.ConvertSeqNode(function(b$){return b0(b8,b$);},b7);b5.set_Item(b8,b9);return b9.e;},by.ofSeq(b3));b2[0]=b5;return b6;},b1);};y.ConvertSeqNode=function(bZ,b0){var b1,b2;b1=x.Create$1(b0);b2=b1.get_View();return{e:bZ(b2),r:b1,w:b2};};y.MapSeqCached=function(bZ,b0){return y.MapSeqCachedBy(a.id,bZ,b0);};y.MapSeqCachedBy=function(bZ,b0,b1){var b2;b2=[new bP.New$5()];return y.Map(function(b3){var b4,b5,b6;b4=b2[0];b5=new bP.New$5();b6=d.mapInPlace(function(b7){var b8,b9;b8=bZ(b7);b9=b4.ContainsKey(b8)?b4.get_Item(b8):b0(b7);b5.set_Item(b8,b9);return b9;},by.ofSeq(b3));b2[0]=b5;return b6;},b1);};y.SnapshotOn=function(bZ,b0,b1){var b2;b2=w.New({$:2,$0:bZ,$1:[]});return y.CreateLazy(function(){return b2.s==null?w.SnapshotOn(b0(),b1()):(w.WhenObsolete(b0(),b2),b2);});};y.GetAsync=function(bZ){return bJ.FromContinuations(function(b0){return y.Get(b0,bZ);});};y.WithInitOption=function(bZ){return y.CreateLazy(function(){return w.WithInitOption(bZ());});};y.WithInit=function(bZ,b0){return y.CreateLazy(function(){return w.WithInit(bZ,b0());});};y.Get=function(bZ,b0){var b1;function b2(){w.WhenRun(b0(),function(b3){if(!b1[0]){b1[0]=true;bZ(b3);}},function(){if(!b1[0])b2();});}b1=[false];b2();};y.MapAsync2=function(bZ,b0,b1){return y.MapAsync(a.id,y.Map2(bZ,b0,b1));};y.MapAsync=function(bZ,b0){return y.CreateLazy(function(){return w.MapAsync(bZ,b0());});};y.Map3=function(bZ,b0,b1,b2){return y.CreateLazy(function(){return w.Map3(bZ,b0(),b1(),b2());});};y.Map2Unit=function(bZ,b0){return y.CreateLazy(function(){return w.Map2Unit(bZ(),b0());});};y.Map2=function(bZ,b0,b1){return y.CreateLazy(function(){return w.Map2(bZ,b0(),b1());});};y.MapCached=function(bZ,b0){return y.MapCachedBy(bH.Equals,bZ,b0);};y.MapCachedBy=function(bZ,b0,b1){var b2;b2=[null];return y.CreateLazy(function(){return w.MapCachedBy(bZ,b2,b0,b1());});};y.Map=function(bZ,b0){return y.CreateLazy(function(){return w.Map(bZ,b0());});};y.CreateLazy=function(bZ){var b0;b0={c:null,o:bZ};return function(){var b1,b2;b1=b0.c;return b1===null?(b1=b0.o(),b0.c=b1,(b2=b1.s,b2!=null&&b2.$==0)?b0.o=null:w.WhenObsoleteRun(b1,function(){b0.c=null;}),b1):b1;};};B=c.FromView=bG.Class({get_Id:function(){return"uinref"+a.String(this.id);},SetFinal:function(bZ){this.set(bZ);},Update:function(bZ){var b0;y.Get((b0=this.set,function(b1){return b0(bZ(b1));}),this.view);},UpdateMaybe:function(bZ){var b0;b0=this;y.Get(function(b1){var b2;b2=bZ(b1);b2!=null&&b2.$==1?b0.set(b2.$0):void 0;},this.view);},Set:function(bZ){this.set(bZ);},Get:function(){return this.current;},get_View:function(){return this.view;}},x,B);B.New=bG.Ctor(function(bZ,b0){var b1;b1=this;x.New.call(this);this.set=b0;this.id=h.Int();this.current=null;this.view=y.Map(function(b2){b1.current=b2;return b2;},bZ);},B);C.B={$:0};D=c.Submitter=bG.Class({Trigger:function(){this["var"].Set(null);}},k,D);D.New=bG.Ctor(function(bZ,b0){this.input=bZ;this["var"]=x.Create();this.view=y.SnapshotOn(b0,this["var"].get_View(),this.input);},D);D.CreateOption=function(bZ){return new D.New(y.Map(function(b0){return{$:1,$0:b0};},bZ),null);};E.Fresh=function(){return{$:0,$0:h.Int()};};F=c.Model=bG.Class({},k,F);F.New=bG.Ctor(function(bZ,b0){var b1;b1=x.Create$1(b0);F.New$1.call(this,b1,y.Map(bZ,b1.get_View()));},F);F.New$1=bG.Ctor(function(bZ,b0){this["var"]=bZ;this.view=b0;},F);F.Update=function(bZ,b0){x.Update(b0["var"],function(b1){bZ(b1);return b1;});};F.Create=function(bZ,b0){return new F.New(bZ,b0);};G.Default=function(){M.$cctor();return M.Default;};I=H.ArrayStorage=bG.Class({SSet:function(bZ){return by.ofSeq(bZ);},SSetAt:function(bZ,b0,b1){by.set(b1,bZ,b0);return b1;},SRemoveIf:function(bZ,b0){return by.filter(function(b1){return!bZ(b1);},b0);},SInit:function(){return this.init;},SPrependMany:function(bZ,b0){var b1;b1=d.ofSeqNonCopying(bZ);b0.unshift.apply(b0,b1);return b0;},SPrepend:function(bZ,b0){b0.unshift(bZ);return b0;},SAppendMany:function(bZ,b0){var b1;b1=d.ofSeqNonCopying(bZ);b0.push.apply(b0,b1);return b0;},SAppend:function(bZ,b0){b0.push(bZ);return b0;}},k,I);I.New=bG.Ctor(function(bZ){this.init=bZ;},I);J=H.LocalStorageBackend=bG.Class({clear:function(){this.storage.removeItem(this.id);},set:function(bZ){this.storage.setItem(this.id,bQ.stringify(by.map(this.serializer.Encode,bZ)));return bZ;},SSet:function(bZ){return this.set(by.ofSeq(bZ));},SSetAt:function(bZ,b0,b1){by.set(b1,bZ,b0);return this.set(b1);},SRemoveIf:function(bZ,b0){return this.set(by.filter(function(b1){return!bZ(b1);},b0));},SInit:function(){var bZ;bZ=this.storage.getItem(this.id);if(bZ===null)return[];else try{return by.map(this.serializer.Decode,bQ.parse(bZ));}catch(b0){return[];}},SPrependMany:function(bZ,b0){var b1;b1=d.ofSeqNonCopying(bZ);b0.unshift.apply(b0,b1);return this.set(b0);},SPrepend:function(bZ,b0){b0.unshift(bZ);return this.set(b0);},SAppendMany:function(bZ,b0){var b1;b1=d.ofSeqNonCopying(bZ);b0.push.apply(b0,b1);return this.set(b0);},SAppend:function(bZ,b0){b0.push(bZ);return this.set(b0);}},k,J);J.New=bG.Ctor(function(bZ,b0){this.id=bZ;this.serializer=b0;this.storage=a.localStorage;},J);H.LocalStorage=function(bZ,b0){return new J.New(bZ,b0);};H.InMemory=function(bZ){return new I.New(bZ);};K=c.ListModel=bG.Class({Wrap:function(bZ,b0,b1){return K.Wrap(this,bZ,b0,b1);},MapLens:function(bZ){var b0;b0=this;return y.MapSeqCachedViewBy(b0.key,function(b1,b2){return bZ(b1,b0["LensInto'"](a.id,function(b3,b4){return b4;},b1,b2));},this["var"].get_View());},Lens:function(bZ){return this.LensInto(a.id,function(b0,b1){return b1;},bZ);},LensInto:function(bZ,b0,b1){return this["LensInto'"](bZ,b0,b1,y.Map(bZ,this.FindByKeyAsView(b1)));},"LensInto'":function(bZ,b0,b1,b2){var b3,b4,b5;b3=this;b4=h.Id();b5=new x({Get:function(){return bZ(b3.FindByKey(b1));},Set:function(b6){return b3.UpdateBy(function(b7){return{$:1,$0:b0(b7,b6)};},b1);},SetFinal:function(b6){return this.Set(b6);},Update:function(b6){return b3.UpdateBy(function(b7){return{$:1,$0:b0(b7,b6(bZ(b7)))};},b1);},UpdateMaybe:function(b6){return b3.UpdateBy(function(b7){var b8;b8=b6(bZ(b7));return b8==null?null:{$:1,$0:b0(b7,b8.$0)};},b1);},get_View:function(){return b2;},get_Id:function(){return b4;}});x.New.call(b5);return b5;},get_LengthAsView:function(){return y.Map(by.length,this["var"].get_View());},get_Length:function(){return by.length(this["var"].Get());},Clear:function(){this["var"].Set(this.storage.SSet([]));this.ObsoleteAll();},UpdateBy:function(bZ,b0){var b1,b2,b3,b4,b5;b1=this;b2=this["var"].Get();b3=by.tryFindIndex(function(b6){return bH.Equals(b1.key(b6),b0);},b2);b3!=null&&b3.$==1?(b4=b3.$0,b5=bZ(by.get(b2,b4)),b5!=null&&b5.$==1?(this["var"].Set(this.storage.SSetAt(b4,b5.$0,b2)),this.ObsoleteKey(b0)):void 0):void 0;},UpdateAll:function(bZ){var b0;b0=this;this["var"].Update(function(b1){by.iteri(function(b2,b3){var b4;b4=bZ(b3);return b4==null?null:by.set(b1,b2,b4.$0);},b1);return b0.storage.SSet(b1);});this.ObsoleteAll();},FindByKeyAsView:function(bZ){return y.Map(function(b0){return b0.$0;},this.TryFindByKeyAsView(bZ));},TryFindByKeyAsView:function(bZ){var b0;b0=this;return function(){var b1,b2,b3;b1=(b2=null,[b0.it.TryGetValue(bZ,{get:function(){return b2;},set:function(b4){b2=b4;}}),b2]);return b1[0]?b1[1]:(b3=w.New({$:2,$0:b0.TryFindByKey(bZ),$1:[]}),(b0.it.Add(bZ,b3),b3));};},TryFindByKey:function(bZ){var b0;b0=this;return by.tryFind(function(b1){return bH.Equals(b0.key(b1),bZ);},this["var"].Get());},FindByKey:function(bZ){var b0;b0=this;return by.find(function(b1){return bH.Equals(b0.key(b1),bZ);},this["var"].Get());},TryFindAsView:function(bZ){return y.Map(function(b0){return by.tryFind(bZ,b0);},this["var"].get_View());},FindAsView:function(bZ){return y.Map(function(b0){return by.find(bZ,b0);},this["var"].get_View());},TryFind:function(bZ){return by.tryFind(bZ,this["var"].Get());},Find:function(bZ){return by.find(bZ,this["var"].Get());},ContainsKeyAsView:function(bZ){var b0;function b1(b2){return bH.Equals(b0.key(b2),bZ);}b0=this;return y.Map(function(b2){return by.exists(b1,b2);},this["var"].get_View());},ContainsKey:function(bZ){var b0;b0=this;return by.exists(function(b1){return bH.Equals(b0.key(b1),bZ);},this["var"].Get());},Set:function(bZ){this["var"].Set(this.storage.SSet(bZ));this.ObsoleteAll();},Iter:function(bZ){by.iter(bZ,this["var"].Get());},RemoveByKey:function(bZ){var b0;b0=this;this["var"].Set(this.storage.SRemoveIf(function(b1){return bH.Equals(b0.key(b1),bZ);},this["var"].Get()));this.ObsoleteKey(bZ);},RemoveBy:function(bZ){var b0,b1,b2,b3;b0=this["var"].Get();for(b1=0,b2=b0.length-1;b1<=b2;b1++){b3=by.get(b0,b1);bZ(b3)?this.ObsoleteKey(this.key(b3)):void 0;}this["var"].Set(this.storage.SRemoveIf(bZ,this["var"].Get()));},Remove:function(bZ){var b0,b1,b2,b3;b0=this;b1=this["var"].Get();L.Contains(b0.key,bZ,b1)?(b2=b0.key,b3=b2(bZ),this["var"].Set(this.storage.SRemoveIf(function(b4){return bH.Equals(b2(b4),b3);},b1)),this.ObsoleteKey(b3)):void 0;},PrependMany:function(bZ){var b0,b1;function b2(b3,b4){var b5,b6;b5=b0.key(b4);b0.ObsoleteKey(b5);b6=by.tryFindIndex(function(b7){return bH.Equals(b0.key(b7),b5);},b3);return b6==null?(b1.push(b4),b3):b0.storage.SSetAt(b6.$0,b4,b3);}b0=this;b1=[];this["var"].Set(this.storage.SPrependMany(b1,(((bG.Curried3(bE.fold))(b2))(this["var"].Get()))(bZ)));},Prepend:function(bZ){var b0,b1,b2,b3;b0=this;b1=this["var"].Get();b2=this.key(bZ);b3=by.tryFindIndex(function(b4){return bH.Equals(b0.key(b4),b2);},b1);b3!=null&&b3.$==1?this["var"].Set(this.storage.SSetAt(b3.$0,bZ,b1)):this["var"].Set(this.storage.SPrepend(bZ,b1));this.ObsoleteKey(b2);},AppendMany:function(bZ){var b0,b1;function b2(b3,b4){var b5,b6;b5=b0.key(b4);b0.ObsoleteKey(b5);b6=by.tryFindIndex(function(b7){return bH.Equals(b0.key(b7),b5);},b3);return b6==null?(b1.push(b4),b3):b0.storage.SSetAt(b6.$0,b4,b3);}b0=this;b1=[];this["var"].Set(this.storage.SAppendMany(b1,(((bG.Curried3(bE.fold))(b2))(this["var"].Get()))(bZ)));},Append:function(bZ){var b0,b1,b2,b3;b0=this;b1=this["var"].Get();b2=this.key(bZ);b3=by.tryFindIndex(function(b4){return bH.Equals(b0.key(b4),b2);},b1);b3!=null&&b3.$==1?this["var"].Set(this.storage.SSetAt(b3.$0,bZ,b1)):this["var"].Set(this.storage.SAppend(bZ,b1));this.ObsoleteKey(b2);},ObsoleteAll:function(){bE.iter(function(bZ){w.Obsolete(bZ.V);},this.it);this.it.Clear();},ObsoleteKey:function(bZ){var b0,b1;b0=(b1=null,[this.it.TryGetValue(bZ,{get:function(){return b1;},set:function(b2){b1=b2;}}),b1]);b0[0]?(w.Obsolete(b0[1]),this.it.Remove(bZ)):void 0;},GetEnumerator0:function(){return bz.Get0(this["var"].Get());},GetEnumerator:function(){return bz.Get(this["var"].Get());}},k,K);K.New=bG.Ctor(function(bZ,b0){K.New$3.call(this,bZ,x.Create$1(by.ofSeq(bE.distinctBy(bZ,b0.SInit()))),b0);},K);K.New$1=bG.Ctor(function(bZ){K.New$2.call(this,bZ,[]);},K);K.New$2=bG.Ctor(function(bZ,b0){var b1;b1=by.ofSeq(b0);K.New$3.call(this,bZ,x.Create$1(b1),H.InMemory(b1));},K);K.New$3=bG.Ctor(function(bZ,b0,b1){this.key=bZ;this["var"]=b0;this.storage=b1;this.v=y.Map(function(b2){return b2.slice();},this["var"].get_View());this.it=new bP.New$5();},K);L.Contains=function(bZ,b0,b1){var b2;b2=bZ(b0);return by.exists(function(b3){return bH.Equals(bZ(b3),b2);},b1);};K.Wrap=function(bZ,b0,b1,b2){var b3,b4;b3=[new bP.New$5()];b4=by.map(function(b5){var b6;b6=b1(b5);b3[0].set_Item(bZ.key(b5),b6);return b6;},bZ["var"].Get());return new K.New$3(function(b5){return bZ.key(b0(b5));},x.Lens(bZ["var"],function(b5){var b6,b7;b6=new bP.New$5();b7=by.map(function(b8){var b9,b_;b9=bZ.key(b8);b_=b3[0].ContainsKey(b9)?b2(b3[0].get_Item(b9),b8):b1(b8);b6.set_Item(b9,b_);return b_;},b5);b3[0]=b6;return b7;},function(b5,b6){var b7,b8;b7=new bP.New$5();b8=by.map(function(b9){var b_;b_=b0(b9);b7.set_Item(bZ.key(b_),b9);return b_;},b6);b3[0]=b7;return b8;}),H.InMemory(b4));};K.FromSeq=function(bZ){return K.Create(a.id,bZ);};K.Create=function(bZ,b0){return K.CreateWithStorage(bZ,H.InMemory(by.ofSeq(b0)));};K.CreateWithStorage=function(bZ,b0){return new K.New(bZ,b0);};M.$cctor=function(){M.$cctor=a.ignore;M.Default={Encode:a.id,Decode:a.id};};N=c.ReactiveExtensions=bG.Class({},k,N);N.New=bG.Ctor(function(){},N);O=c.DoubleInterpolation=bG.Class({Interpolate:function(bZ,b0,b1){return b0+bZ*(b1-b0);}},null,O);O.DoubleInterpolation=new O({$:0});P.get_Double=function(){return O.DoubleInterpolation;};Q=c.Easing=bG.Class({TransformTime:function(bZ){return this.transformTime(bZ);}},k,Q);Q.get_CubicInOut=function(){return R.CubicInOut();};Q.Custom=function(bZ){return new Q.New(bZ);};Q.New=bG.Ctor(function(bZ){this.transformTime=bZ;},Q);R.CubicInOut=function(){V.$cctor();return V.CubicInOut;};S.get_Empty=function(){return{$:0,$0:p.Empty()};};S.WhenDone=function(bZ,b0){return S.Append({$:0,$0:p.Single({$:0,$0:bZ})},b0);};S.Run=function(bZ,b0){var b1;function b2(b3){function b4(b5,b6){var b7;b7=b6-b5;b0.Compute(b7);bZ();return b7<=b1?void a.requestAnimationFrame(function(b8){b4(b5,b8);}):b3();}a.requestAnimationFrame(function(b5){b4(b5,b5);});}b1=b0.Duration;return b1===0?bJ.Zero():bJ.FromContinuations(function(b3,b4,b5){return b2.apply(null,[b3,b4,b5]);});};S.Play=function(bZ){var b0;b0=null;return bJ.Delay(function(){return bJ.Bind(S.Run(a.ignore,T.Actions(bZ)),function(){T.Finalize(bZ);return bJ.Return(null);});});};S.Pack=function(bZ){return{$:0,$0:p.Single({$:1,$0:bZ})};};S.Map=function(bZ,b0){var b1;return T.Def(b0.Duration,(b1=b0.Compute,function(b2){return bZ(b1(b2));}));};S.Delayed=function(bZ,b0,b1,b2,b3,b4){return{Compute:function(b5){return b5<=b2?b3:bZ.Interpolate(b0.TransformTime((b5-b2)/b1),b3,b4);},Duration:b1+b2};};S.Simple=function(bZ,b0,b1,b2,b3){return{Compute:function(b4){return bZ.Interpolate(b0.TransformTime(b4/b1),b2,b3);},Duration:b1};};S.Const=function(bZ){return T.Const(bZ);};S.Concat=function(bZ){return{$:0,$0:p.Concat(bE.map(T.List,bZ))};};S.Append=function(bZ,b0){return{$:0,$0:p.Append(bZ.$0,b0.$0)};};S.set_UseAnimations=function(bZ){T.set_UseAnimations(bZ);};S.get_UseAnimations=function(){return T.UseAnimations();};T.UseAnimations=function(){V.$cctor();return V.UseAnimations;};T.set_UseAnimations=function(bZ){V.$cctor();V.UseAnimations=bZ;};T.Actions=function(bZ){return T.ConcatActions(by.choose(function(b0){return b0.$==1?{$:1,$0:b0.$0}:null;},p.ToArray(bZ.$0)));};T.ConcatActions=function(bZ){var b0,b1,b2,b3;b0=d.ofSeqNonCopying(bZ);b1=by.length(b0);return b1===0?T.Const():b1===1?by.get(b0,0):(b2=bE.max(bE.map(function(b4){return b4.Duration;},b0)),(b3=by.map(function(b4){return T.Prolong(b2,b4);},b0),T.Def(b2,function(b4){by.iter(function(b5){b5.Compute(b4);},b3);})));};T.Prolong=function(bZ,b0){var b1,b2,b3;b1=b0.Compute;b2=b0.Duration;b3=bO.Create(function(){return b0.Compute(b0.Duration);});return{Compute:function(b4){return b4>=b2?b3.f():b1(b4);},Duration:bZ};};T.Const=function(bZ){return T.Def(0,function(){return bZ;});};T.Def=function(bZ,b0){return{Compute:b0,Duration:bZ};};T.Finalize=function(bZ){by.iter(function(b0){if(b0.$==0)b0.$0();},p.ToArray(bZ.$0));};T.List=function(bZ){return bZ.$0;};U=c.Trans=bG.Class({Copy:function(bZ,b0,b1,b2){var b3,b4,b5,b6,b7;function b8(b9,b_){return b3.TChange(b9,b_);}b3=this;b4=bZ==null?function(b9){return function(b_){return b8(b9,b_);};}:bZ.$0;return new U.New$3(function(b9,b_){return(b4(b9))(b_);},(b5=this.get_TEnter(),b0==null?b5:b0.$0),(b6=this.get_TExit(),b1==null?b6:b1.$0),(b7=this.get_TFlags(),b2==null?b7:b2.$0));},get_TFlags:function(){return this.flags;},get_TExit:function(){return this.exit;},get_TEnter:function(){return this.enter;},TChange:function(bZ,b0){return this.change(bZ,b0);}},k,U);U.New=bG.Ctor(function(bZ,b0,b1){U.New$3.call(this,bZ,bH.Equals(b0,null)?S.Const:b0,bH.Equals(b1,null)?S.Const:b1,1|(bH.Equals(b0,null)?0:2)|(bH.Equals(b1,null)?0:4));},U);U.New$1=bG.Ctor(function(bZ){U.New$3.call(this,bZ,S.Const,S.Const,1);},U);U.New$2=bG.Ctor(function(){U.New$3.call(this,function(bZ,b0){return S.Const(b0);},S.Const,S.Const,0);},U);U.New$3=bG.Ctor(function(bZ,b0,b1,b2){this.change=bZ;this.enter=b0;this.exit=b1;this.flags=b2;},U);U.Exit=function(bZ,b0){return b0.Copy(null,null,{$:1,$0:bZ},{$:1,$0:b0.get_TFlags()|4});};U.Enter=function(bZ,b0){return b0.Copy(null,{$:1,$0:bZ},null,{$:1,$0:b0.get_TFlags()|2});};U.Change=function(bZ,b0){return b0.Copy({$:1,$0:bZ},null,null,{$:1,$0:b0.get_TFlags()|1});};U.Create=function(bZ){return new U.New$1(bZ);};U.Trivial=function(){return new U.New$2();};U.CanAnimateExit=function(bZ){var b0,b1;b0=bZ.get_TFlags();b1=4;return(b0&b1)===b1;};U.CanAnimateEnter=function(bZ){var b0,b1;b0=bZ.get_TFlags();b1=2;return(b0&b1)===b1;};U.CanAnimateChange=function(bZ){var b0,b1;b0=bZ.get_TFlags();b1=1;return(b0&b1)===b1;};U.AnimateExit=function(bZ,b0){return(bZ.get_TExit())(b0);};U.AnimateEnter=function(bZ,b0){return(bZ.get_TEnter())(b0);};U.AnimateChange=function(bZ,b0,b1){return bZ.TChange(b0,b1);};V.$cctor=function(){V.$cctor=a.ignore;V.CubicInOut=Q.Custom(function(bZ){var b0;b0=bZ*bZ;return 3*b0-2*(b0*bZ);});V.UseAnimations=true;};Y=c.OnAfterRenderControl=bG.Class({get_Body:function(){var bZ,b0,b1,b2,b3;bZ=a.document.querySelectorAll("[ws-runafterrender]");for(b0=0,b1=bZ.length-1;b0<=b1;b0++){b2=bZ[b0];b3=a["eval"](b2.getAttribute("ws-runafterrender"));b2.removeAttribute("ws-runafterrender");b3(b2);}return{ReplaceInDom:function(){return null;}};}},X,Y);Z=c.AnimatedAttrNode=bG.Class({sync:function(bZ){var b0;if(this.dirty){b0=this.logical;b0==null?void 0:(this.push(bZ))(b0.$0);this.visible=this.logical;this.dirty=false;}},pushVisible:function(bZ,b0){this.visible={$:1,$0:b0};this.dirty=true;(this.push(bZ))(b0);},NChanged:function(){return this.updates;},NSync:a.ignore,NGetExitAnim:function(bZ){var b0,b1;b0=this;return S.WhenDone(function(){b0.dirty=true;b0.visible=null;},(b1=this.visible,b1!=null&&b1.$==1?S.Pack(S.Map(function(b2){b0.pushVisible(bZ,b2);},U.AnimateExit(this.tr,b1.$0))):S.get_Empty()));},NGetEnterAnim:function(bZ){var b0,b1,b2,b3,b4;b0=this;return S.WhenDone(function(){b0.sync(bZ);},(b1=this.visible,(b2=this.logical,b1!=null&&b1.$==1&&(b2!=null&&b2.$==1&&(this.dirty&&(b3=[b2.$0,b1.$0],true)))?S.Pack(S.Map(function(b5){b0.pushVisible(bZ,b5);},U.AnimateChange(this.tr,b3[1],b3[0]))):b1==null&&(b2!=null&&b2.$==1)?S.Pack(S.Map(function(b5){b0.pushVisible(bZ,b5);},U.AnimateEnter(this.tr,b2.$0))):S.get_Empty())));},NGetChangeAnim:function(bZ){var b0,b1,b2,b3;b0=this;return S.WhenDone(function(){b0.sync(bZ);},(b1=this.visible,(b2=this.logical,b1!=null&&b1.$==1&&(b2!=null&&b2.$==1&&(this.dirty&&(b3=[b2.$0,b1.$0],true)))?S.Pack(S.Map(function(b4){b0.pushVisible(bZ,b4);},U.AnimateChange(this.tr,b3[1],b3[0]))):S.get_Empty())));}},k,Z);Z.New=bG.Ctor(function(bZ,b0,b1){var b2;b2=this;this.tr=bZ;this.push=b1;this.logical=null;this.visible=null;this.dirty=true;this.updates=y.Map(function(b3){b2.logical={$:1,$0:b3};b2.dirty=true;},b0);},Z);_0=c.DynamicAttrNode=bG.Class({NChanged:function(){return this.updates;},NSync:function(bZ){if(this.dirty){(this.push(bZ))(this.value);this.dirty=false;}},NGetExitAnim:function(bZ){return S.get_Empty();},NGetEnterAnim:function(bZ){return S.get_Empty();},NGetChangeAnim:function(bZ){return S.get_Empty();}},k,_0);_0.New=bG.Ctor(function(bZ,b0){var b1;b1=this;this.push=b0;this.value=void 0;this.dirty=false;this.updates=y.Map(function(b2){b1.value=b2;b1.dirty=true;},bZ);},_0);_1=c.AttrProxy=bG.Class({},null,_1);_1.Handler=function(bZ,b0){return _1.HandlerImpl(bZ,b0);};_1.HandlerImpl=function(bZ,b0){return _5.Static(function(b1){b1.addEventListener(bZ,function(b2){return(b0(b1))(b2);},false);});};_1.OnAfterRenderImpl=function(bZ){return new _1({$:4,$0:bZ});};_1.Concat=function(bZ){var b0;b0=d.ofSeqNonCopying(bZ);return d.TreeReduce(_5.EmptyAttr(),_1.Append,b0);};_1.Append=function(bZ,b0){return _5.AppendTree(bZ,b0);};_1.Create=function(bZ,b0){return _5.Static(function(b1){r.SetAttr(b1,bZ,b0);});};_4.New=function(bZ,b0,b1,b2){var b3;b3={DynElem:bZ,DynFlags:b0,DynNodes:b1};bG.SetOptional(b3,"OnAfterRender",b2);return b3;};_5.Static=function(bZ){return new _1({$:3,$0:bZ});};_5.Dynamic=function(bZ,b0){return new _1({$:1,$0:new _0.New(bZ,b0)});};_5.Animated=function(bZ,b0,b1){var b2,b3,b4;b2=new Z.New(bZ,b0,b1);b3=4;U.CanAnimateEnter(bZ)?b3=b3|1:void 0;U.CanAnimateExit(bZ)?b3=b3|2:void 0;b4=new _1({$:1,$0:b2});_5.SetFlags(b4,b3);return b4;};_5.EmptyAttr=function(){_8.$cctor();return _8.EmptyAttr;};_5.AppendTree=function(bZ,b0){var b1;return bZ===null?b0:b0===null?bZ:(b1=new _1({$:2,$0:bZ,$1:b0}),(_5.SetFlags(b1,_5.Flags(bZ)|_5.Flags(b0)),b1));};_5.GetChangeAnim=function(bZ){return _5.GetAnim(bZ,function(b0,b1){return b0.NGetChangeAnim(b1);});};_5.GetExitAnim=function(bZ){return _5.GetAnim(bZ,function(b0,b1){return b0.NGetExitAnim(b1);});};_5.GetEnterAnim=function(bZ){return _5.GetAnim(bZ,function(b0,b1){return b0.NGetEnterAnim(b1);});};_5.GetAnim=function(bZ,b0){return S.Concat(by.map(function(b1){return b0(b1,bZ.DynElem);},bZ.DynNodes));};_5.Updates=function(bZ){return d.MapTreeReduce(function(b0){return b0.NChanged();},y.Const(),y.Map2Unit,bZ.DynNodes);};_5.Empty=function(bZ){return _4.New(bZ,0,[],null);};_5.Insert=function(bZ,b0){var b1,b2,b3;function b4(b5){if(!(b5===null))if(b5!=null&&b5.$==1)b1.push(b5.$0);else if(b5!=null&&b5.$==2){b4(b5.$0);b4(b5.$1);}else if(b5!=null&&b5.$==3)b5.$0(bZ);else if(b5!=null&&b5.$==4)b2.push(b5.$0);}b1=[];b2=[];b4(b0);b3=b1.slice(0);return _4.New(bZ,_5.Flags(b0),b3,b2.length===0?null:{$:1,$0:function(b5){bE.iter(function(b6){b6(b5);},b2);}});};_5.Sync=function(bZ,b0){by.iter(function(b1){b1.NSync(bZ);},b0.DynNodes);};_5.SetFlags=function(bZ,b0){bZ.flags=b0;};_5.Flags=function(bZ){return bZ!==null&&bZ.hasOwnProperty("flags")?bZ.flags:0;};_5.HasExitAnim=function(bZ){var b0;b0=2;return(bZ.DynFlags&b0)===b0;};_5.HasEnterAnim=function(bZ){var b0;b0=1;return(bZ.DynFlags&b0)===b0;};_5.HasChangeAnim=function(bZ){var b0;b0=4;return(bZ.DynFlags&b0)===b0;};_6=c.CheckedInput=bG.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,_6);_6.Make=function(bZ){return new _6({$:0,$0:bZ,$1:a.String(bZ)});};_7.ValidateForm=function(){return _7.OnAfterRender(function(bZ){if(window.H5F)window.H5F.setup(bZ);});};_7.Checked=function(bZ){function b0(b1,b2){return!bH.Equals(bZ.Get(),b1.checked)?bZ.Set(b1.checked):null;}return _1.Concat([_7.DynamicProp("checked",bZ.get_View()),_7.Handler("change",function(b1){return function(b2){return b0(b1,b2);};}),_7.Handler("click",function(b1){return function(b2){return b0(b1,b2);};})]);};_7.FloatValue=function(bZ){return _7.CustomVar(bZ,function(b0,b1){var b2;b2=b1.get_Input();return b0.value!==b2?void(b0.value=b2):null;},function(b0){var b1,b2;b1=b0.value;return{$:1,$0:e.isBlank(b1)?(b0.checkValidity?b0.checkValidity():true)?new _6({$:2,$0:b1}):new _6({$:1,$0:b1}):(b2=+b1,a.isNaN(b2)?new _6({$:1,$0:b1}):new _6({$:0,$0:b2,$1:b1}))};});};_7.FloatValueUnchecked=function(bZ){return _7.CustomValue(bZ,a.String,function(b0){var b1;return e.isBlank(b0)?{$:1,$0:0}:(b1=+b0,a.isNaN(b1)?null:{$:1,$0:b1});});};_7.IntValue=function(bZ){return _7.CustomVar(bZ,function(b0,b1){var b2;b2=b1.get_Input();return b0.value!==b2?void(b0.value=b2):null;},function(b0){var b1,b2,b3;b1=b0.value;return{$:1,$0:e.isBlank(b1)?(b0.checkValidity?b0.checkValidity():true)?new _6({$:2,$0:b1}):new _6({$:1,$0:b1}):(b2=(b3=0,[bR.TryParseInt32(b1,{get:function(){return b3;},set:function(b4){b3=b4;}}),b3]),b2[0]?new _6({$:0,$0:b2[1],$1:b1}):new _6({$:1,$0:b1}))};});};_7.IntValueUnchecked=function(bZ){return _7.CustomValue(bZ,a.String,function(b0){var b1;return e.isBlank(b0)?{$:1,$0:0}:(b1=+b0,b1!==b1>>0?null:{$:1,$0:b1});});};_7.Value=function(bZ){function b0(b1){return{$:1,$0:b1};}return _7.CustomValue(bZ,a.id,function(b1){return b0(a.id(b1));});};_7.ContentEditableHtml=function(bZ){var b0;b0=_7.CustomVar(bZ,function(b1,b2){b1.innerHTML=b2;},function(b1){return{$:1,$0:b1.innerHTML};});return _1.Append(_1.Create("contenteditable","true"),b0);};_7.ContentEditableText=function(bZ){var b0;b0=_7.CustomVar(bZ,function(b1,b2){b1.textContent=b2;},function(b1){return{$:1,$0:b1.textContent};});return _1.Append(_1.Create("contenteditable","true"),b0);};_7.CustomValue=function(bZ,b0,b1){return _7.CustomVar(bZ,function(b2,b3){b2.value=b0(b3);},function(b2){return b1(b2.value);});};_7.CustomVar=function(bZ,b0,b1){function b2(b4,b5){return bZ.UpdateMaybe(function(b6){var b7,b8;b7=b1(b4);return b7!=null&&b7.$==1&&(!bH.Equals(b7.$0,b6)&&(b8=[b7,b7.$0],true))?b8[0]:null;});}function b3(b4,b5){var b6,b7;b6=b1(b4);return b6!=null&&b6.$==1&&(bH.Equals(b6.$0,b5)&&(b7=b6.$0,true))?null:b0(b4,b5);}return _1.Concat([_7.Handler("change",function(b4){return function(b5){return b2(b4,b5);};}),_7.Handler("input",function(b4){return function(b5){return b2(b4,b5);};}),_7.Handler("keypress",function(b4){return function(b5){return b2(b4,b5);};}),_7.DynamicCustom(function(b4){return function(b5){return b3(b4,b5);};},bZ.get_View())]);};_7.DynamicProp=function(bZ,b0){return _5.Dynamic(b0,function(b1){return function(b2){b1[bZ]=b2;};});};_7.DynamicPred=function(bZ,b0,b1){function b2(b3,b4){return b4[0]?r.SetAttr(b3,bZ,b4[1]):r.RemoveAttr(b3,bZ);}return _5.Dynamic(y.Map2(function(b3,b4){return[b3,b4];},b0,b1),function(b3){return function(b4){return b2(b3,b4);};});};_7.DynamicClass=function(bZ,b0,b1){return _7.DynamicClassPred(bZ,y.Map(b1,b0));};_7.Class=function(bZ){return _7.ClassPred(bZ,true);};_7.ClassPred=function(bZ,b0){return _5.Static(function(b1){if(b0)r.AddClass(b1,bZ);else r.RemoveClass(b1,bZ);});};_7.DynamicClassPred=function(bZ,b0){return _5.Dynamic(b0,function(b1){return function(b2){return b2?r.AddClass(b1,bZ):r.RemoveClass(b1,bZ);};});};_7.OnAfterRenderView=function(bZ,b0){var b1;b1=h.Id();return _1.Append(_7.OnAfterRender(function(b2){b0(b2,b2[b1]);}),_7.DynamicCustom(function(b2){return function(b3){b2[b1]=b3;};},bZ));};_7.OnAfterRender=function(bZ){return new _1({$:4,$0:bZ});};_7.HandlerView=function(bZ,b0,b1){return _5.Static(function(b2){var b3;b3=b1(b2);b2.addEventListener(bZ,function(b4){return y.Get(b3(b4),b0);},false);});};_7.Handler=function(bZ,b0){return _5.Static(function(b1){b1.addEventListener(bZ,function(b2){return(b0(b1))(b2);},false);});};_7.DynamicStyle=function(bZ,b0){return _5.Dynamic(b0,function(b1){return function(b2){return r.SetStyle(b1,bZ,b2);};});};_7.DynamicCustom=function(bZ,b0){return _5.Dynamic(b0,bZ);};_7.Dynamic=function(bZ,b0){return _5.Dynamic(b0,function(b1){return function(b2){return r.SetAttr(b1,bZ,b2);};});};_7.AnimatedStyle=function(bZ,b0,b1,b2){return _5.Animated(b0,b1,function(b3){return function(b4){return r.SetStyle(b3,bZ,b2(b4));};});};_7.Animated=function(bZ,b0,b1,b2){return _5.Animated(b0,b1,function(b3){return function(b4){return r.SetAttr(b3,bZ,b2(b4));};});};_7.Style=function(bZ,b0){return _5.Static(function(b1){r.SetStyle(b1,bZ,b0);});};_8.$cctor=function(){_8.$cctor=a.ignore;_8.EmptyAttr=null;};_9.BatchUpdatesEnabled=function(){bh.$cctor();return bh.BatchUpdatesEnabled;};_9.set_BatchUpdatesEnabled=function(bZ){bh.$cctor();bh.BatchUpdatesEnabled=bZ;};_=c.DocElemNode=bG.Class({GetHashCode:function(){return this.ElKey;},Equals:function(bZ){return this.ElKey===bZ.ElKey;}},null,_);_.New=function(bZ,b0,b1,b2,b3,b4){var b5;return new _((b5={Attr:bZ,Children:b0,El:b2,ElKey:b3},(bG.SetOptional(b5,"Delimiters",b1),bG.SetOptional(b5,"Render",b4),b5)));};ba.FoldBack=function(bZ,b0,b1){return by.foldBack(bZ,b0.$0,b1);};ba.Iter=function(bZ,b0){by.iter(bZ,b0.$0);};ba.Except=function(bZ,b0){var b1;b1=bZ.$0;return{$:0,$0:by.filter(function(b2){return by.forall(function(b3){return!(b2===b3);},b1);},b0.$0)};};ba.DocChildren=function(bZ){var b0;function b1(b2){if(b2!=null&&b2.$==2)b1(b2.$0.Current);else if(b2!=null&&b2.$==1)b0.push(b2.$0.El);else if(b2==null);else if(b2!=null&&b2.$==5)b0.push(b2.$0);else if(b2!=null&&b2.$==4)b0.push(b2.$0.Text);else if(b2!=null&&b2.$==6)by.iter(function(b3){if(b3.constructor===a.Object)b1(b3);else b0.push(b3);},b2.$0.Els);else{b1(b2.$0);b1(b2.$1);}}b0=[];b1(bZ.Children);return{$:0,$0:d.ofSeqNonCopying(b0)};};ba.Children=function(bZ,b0){var b1,b2,b3;if(b0!=null&&b0.$==1){b3=[];b1=b0.$0[0].nextSibling;while(b1!==b0.$0[1]){b3.push(b1);b1=b1.nextSibling;}return{$:0,$0:b3};}else return{$:0,$0:by.init(bZ.childNodes.length,(b2=bZ.childNodes,function(b4){return b2[b4];}))};};bb.ToArray=function(bZ){return i.ToArray(bZ.$0);};bb.get_Empty=function(){return{$:0,$0:new bD.New$3()};};bb.IsEmpty=function(bZ){return bZ.$0.get_Count()===0;};bb.Intersect=function(bZ,b0){return{$:0,$0:i.Intersect(bZ.$0,b0.$0)};};bb.Except=function(bZ,b0){return{$:0,$0:i.Except(bZ.$0,b0.$0)};};bb.FindAll=function(bZ){var b0;function b1(b3){if(b3!=null&&b3.$==0){b1(b3.$0);b1(b3.$1);}else if(b3!=null&&b3.$==1)b2(b3.$0);else if(b3!=null&&b3.$==2)b1(b3.$0.Current);else if(b3!=null&&b3.$==6)by.iter(b2,b3.$0.Holes);}function b2(b3){b0.push(b3);b1(b3.Children);}b0=[];b1(bZ);return{$:0,$0:new bD.New$2(b0)};};bb.Filter=function(bZ,b0){return{$:0,$0:i.Filter(bZ,b0.$0)};};bc.New=function(bZ,b0){return{PreviousNodes:bZ,Top:b0};};bd.TextHoleRE=function(){bh.$cctor();return bh.TextHoleRE;};bd.LocalTemplatesLoaded=function(){bh.$cctor();return bh.LocalTemplatesLoaded;};bd.set_LocalTemplatesLoaded=function(bZ){bh.$cctor();bh.LocalTemplatesLoaded=bZ;};bd.LoadedTemplateFile=function(bZ){var b0,b1,b2;b0=(b1=null,[bd.LoadedTemplates().TryGetValue(bZ,{get:function(){return b1;},set:function(b3){b1=b3;}}),b1]);return b0[0]?b0[1]:(b2=new bP.New$5(),(bd.LoadedTemplates().set_Item(bZ,b2),b2));};bd.LoadedTemplates=function(){bh.$cctor();return bh.LoadedTemplates;};bd.UpdateTextNode=function(bZ,b0){bZ.Value=b0;bZ.Dirty=true;};bd.CreateTextNode=function(){return{Text:r.CreateText(""),Dirty:false,Value:""};};bd.UpdateEmbedNode=function(bZ,b0){bZ.Current=b0;bZ.Dirty=true;};bd.CreateEmbedNode=function(){return{Current:null,Dirty:false};};bd.PerformSyncUpdate=function(bZ,b0,b1){var b2;b2=bb.FindAll(b1);bd.SyncElemNode(bZ,b0.Top);b0.PreviousNodes=b2;};bd.PerformAnimatedUpdate=function(bZ,b0,b1){var b2;return S.get_UseAnimations()?(b2=null,bJ.Delay(function(){var b3,b4,b5;b3=bb.FindAll(b1);b4=bd.ComputeChangeAnim(b0,b3);b5=bd.ComputeEnterAnim(b0,b3);return bJ.Bind(S.Play(S.Append(b4,bd.ComputeExitAnim(b0,b3))),function(){return bJ.Bind(bd.SyncElemNodesNextFrame(bZ,b0),function(){return bJ.Bind(S.Play(b5),function(){b0.PreviousNodes=b3;return bJ.Return(null);});});});})):bd.SyncElemNodesNextFrame(bZ,b0);};bd.SyncElemNodesNextFrame=function(bZ,b0){function b1(b2){a.requestAnimationFrame(function(){bd.SyncElemNode(bZ,b0.Top);b2();});}return _9.BatchUpdatesEnabled()?bJ.FromContinuations(function(b2,b3,b4){return b1.apply(null,[b2,b3,b4]);}):(bd.SyncElemNode(bZ,b0.Top),bJ.Return(null));};bd.ComputeEnterAnim=function(bZ,b0){return S.Concat(by.map(function(b1){return _5.GetEnterAnim(b1.Attr);},bb.ToArray(bb.Except(bZ.PreviousNodes,bb.Filter(function(b1){return _5.HasEnterAnim(b1.Attr);},b0)))));};bd.ComputeChangeAnim=function(bZ,b0){var b1;function b2(b3){return _5.HasChangeAnim(b3.Attr);}b1=function(b3){return bb.Filter(b2,b3);};return S.Concat(by.map(function(b3){return _5.GetChangeAnim(b3.Attr);},bb.ToArray(bb.Intersect(b1(bZ.PreviousNodes),b1(b0)))));};bd.ComputeExitAnim=function(bZ,b0){return S.Concat(by.map(function(b1){return _5.GetExitAnim(b1.Attr);},bb.ToArray(bb.Except(b0,bb.Filter(function(b1){return _5.HasExitAnim(b1.Attr);},bZ.PreviousNodes)))));};bd.CreateDelimitedRunState=function(bZ,b0,b1){return bc.New(bb.get_Empty(),bd.CreateDelimitedElemNode(bZ,b0,_5.EmptyAttr(),b1));};bd.CreateRunState=function(bZ,b0){return bc.New(bb.get_Empty(),bd.CreateElemNode(bZ,_5.EmptyAttr(),b0));};bd.CreateDelimitedElemNode=function(bZ,b0,b1,b2){var b3,b4;b3=bZ.parentNode;bd.LinkPrevElement(b0,b2);b4=_5.Insert(b3,b1);return _.New(b4,b2,{$:1,$0:[bZ,b0]},b3,h.Int(),bG.GetOptional(b4.OnAfterRender));};bd.CreateElemNode=function(bZ,b0,b1){var b2;bd.LinkElement(bZ,b1);b2=_5.Insert(bZ,b0);return _.New(b2,b1,null,bZ,h.Int(),bG.GetOptional(b2.OnAfterRender));};bd.SyncElemNode=function(bZ,b0){!bZ?bd.SyncElement(b0):void 0;bd.Sync(b0.Children);bd.AfterRender(b0);};bd.Sync=function(bZ){var b0,b1;if(bZ!=null&&bZ.$==1)bd.SyncElemNode(false,bZ.$0);else if(bZ!=null&&bZ.$==2)bd.Sync(bZ.$0.Current);else if(bZ==null);else if(bZ!=null&&bZ.$==5);else if(bZ!=null&&bZ.$==4){b0=bZ.$0;b0.Dirty?(b0.Text.nodeValue=b0.Value,b0.Dirty=false):void 0;}else if(bZ!=null&&bZ.$==6){b1=bZ.$0;by.iter(function(b2){bd.SyncElemNode(false,b2);},b1.Holes);by.iter(function(b2){_5.Sync(b2[0],b2[1]);},b1.Attrs);bd.AfterRender(b1);}else{bd.Sync(bZ.$0);bd.Sync(bZ.$1);}};bd.AfterRender=function(bZ){var b0;b0=bG.GetOptional(bZ.Render);b0!=null&&b0.$==1?(b0.$0(bZ.El),bG.SetOptional(bZ,"Render",null)):void 0;};bd.InsertBeforeDelim=function(bZ,b0){var b1,b2;b1=bZ.parentNode;b2=a.document.createTextNode("");b1.insertBefore(b2,bZ);bd.LinkPrevElement(bZ,b0);return b2;};bd.LinkPrevElement=function(bZ,b0){bd.InsertDoc(bZ.parentNode,b0,bZ);};bd.LinkElement=function(bZ,b0){bd.InsertDoc(bZ,b0,null);};bd.SyncElement=function(bZ){function b0(b1){function b2(b3){var b4,b5;return b3!=null&&b3.$==0?b2(b3.$0)||b2(b3.$1):b3!=null&&b3.$==2?(b4=b3.$0,b4.Dirty||b2(b4.Current)):b3!=null&&b3.$==6&&(b5=b3.$0,b5.Dirty||by.exists(b0,b5.Holes));}return b2(b1.Children);}_5.Sync(bZ.El,bZ.Attr);b0(bZ)?bd.DoSyncElement(bZ):void 0;};bd.DoSyncElement=function(bZ){var b0,b1,b2;function b3(b4,b5){var b6,b7;return b4!=null&&b4.$==1?b4.$0.El:b4!=null&&b4.$==2?(b6=b4.$0,b6.Dirty?(b6.Dirty=false,bd.InsertDoc(b0,b6.Current,b5)):b3(b6.Current,b5)):b4==null?b5:b4!=null&&b4.$==4?b4.$0.Text:b4!=null&&b4.$==5?b4.$0:b4!=null&&b4.$==6?(b7=b4.$0,(b7.Dirty?b7.Dirty=false:void 0,by.foldBack(function(b8,b9){return b8.constructor===a.Object?b3(b8,b9):b8;},b7.Els,b5))):b3(b4.$0,b3(b4.$1,b5));}b0=bZ.El;ba.Iter((b1=bZ.El,function(b4){r.RemoveNode(b1,b4);}),ba.Except(ba.DocChildren(bZ),ba.Children(bZ.El,bG.GetOptional(bZ.Delimiters))));b3(bZ.Children,(b2=bG.GetOptional(bZ.Delimiters),b2!=null&&b2.$==1?b2.$0[1]:null));};bd.InsertDoc=function(bZ,b0,b1){var b2;return b0!=null&&b0.$==1?bd.InsertNode(bZ,b0.$0.El,b1):b0!=null&&b0.$==2?(b2=b0.$0,(b2.Dirty=false,bd.InsertDoc(bZ,b2.Current,b1))):b0==null?b1:b0!=null&&b0.$==4?bd.InsertNode(bZ,b0.$0.Text,b1):b0!=null&&b0.$==5?bd.InsertNode(bZ,b0.$0,b1):b0!=null&&b0.$==6?by.foldBack(function(b3,b4){return b3.constructor===a.Object?bd.InsertDoc(bZ,b3,b4):bd.InsertNode(bZ,b3,b4);},b0.$0.Els,b1):bd.InsertDoc(bZ,b0.$0,bd.InsertDoc(bZ,b0.$1,b1));};bd.InsertNode=function(bZ,b0,b1){r.InsertAt(bZ,b1,b0);return b0;};be=c.Doc=bG.Class({ReplaceInDom:function(bZ){var b0;b0=a.document.createTextNode("");bZ.parentNode.replaceChild(b0,bZ);be.RunBefore(b0,this);}},k,be);be.Append=function(bZ,b0){return be.Mk({$:0,$0:bZ.docNode,$1:b0.docNode},y.Map2Unit(bZ.updates,b0.updates));};be.Concat=function(bZ){var b0;b0=d.ofSeqNonCopying(bZ);return d.TreeReduce(be.Empty(),be.Append,b0);};be.Empty=function(){return be.Mk(null,y.Const());};be.TextNode=function(bZ){return be.Mk({$:5,$0:r.CreateText(bZ)},y.Const());};be.Verbatim=function(bZ){var b0;return be.Mk(d.MapTreeReduce(function(b1){return bH.Equals(b1.nodeType,bS.TEXT_NODE)?{$:5,$0:b1}:{$:1,$0:bd.CreateElemNode(b1,_5.EmptyAttr(),null)};},null,function(b1,b2){return{$:0,$0:b1,$1:b2};},(b0=bT.parseHTML(bZ),bH.Equals(b0,null)?[]:b0)),y.Const());};be.SvgElementMixed=function(bZ,b0){var b1;b1=be.MixedNodes(b0);return be.SvgElement(bZ,b1[0],b1[1]);};be.SvgElement=function(bZ,b0,b1){var b2,b3;b2=_1.Concat(b0);b3=be.Concat(b1);return bf.New(r.CreateSvgElement(bZ),b2,b3);};be.ElementMixed=function(bZ,b0){var b1;b1=be.MixedNodes(b0);return be.Element(bZ,b1[0],b1[1]);};be.ConcatMixed=function(bZ){return be.Concat(bE.map(be.ToMixedDoc,bZ));};be.MixedNodes=function(bZ){var b0,b1,b2,b3;b0=[];b1=[];b2=bz.Get(bZ);try{while(b2.MoveNext()){b3=b2.Current();b3 instanceof _1?b0.push(b3):b1.push(be.ToMixedDoc(b3));}}finally{if("Dispose"in b2)b2.Dispose();}return[b0,b1];};be.ToMixedDoc=function(bZ){return bZ instanceof be?bZ:typeof bZ=="string"?be.TextNode(bZ):bZ instanceof a.Element?be.Static(bZ):typeof bZ=="function"?be.EmbedView(y.Map(be.ToMixedDoc,bZ)):bZ instanceof x?be.EmbedView(y.Map(be.ToMixedDoc,bZ.get_View())):bH.Equals(bZ,null)?be.Empty():be.TextNode(a.String(bZ));};be.Element=function(bZ,b0,b1){var b2,b3;b2=_1.Concat(b0);b3=be.Concat(b1);return bf.New(r.CreateElement(bZ),b2,b3);};be.Radio=function(bZ,b0,b1){var b2,b3;b2=r.CreateElement("input");b2.addEventListener("click",function(){return b1.Set(b0);},false);b3=_7.DynamicProp("checked",y.Map(function(b4){return bH.Equals(b4,b0);},b1.get_View()));return bf.New(b2,_1.Concat(bx.append(bx.ofArray([_1.Create("type","radio"),_1.Create("name",b1.get_Id()),b3]),bx.ofSeq(bZ))),be.Empty());};be.LinkView=function(bZ,b0,b1,b2){var b3;b3=_1.Concat(bE.append([_7.HandlerView("click",b1,function(){return function(){return b2;};}),_1.Create("href","#")],b0));return bf.New(r.CreateElement("a"),b3,be.TextNode(bZ));};be.Link=function(bZ,b0,b1){var b2,b3;b2=(b3=_1.Concat(b0),_1.Append(_1.Create("href","#"),b3));return bf.New(be.Clickable("a",b1),b2,be.TextNode(bZ));};be.ButtonView=function(bZ,b0,b1,b2){var b3;b3=_1.Concat(bE.append([_7.HandlerView("click",b1,function(){return function(){return b2;};})],b0));return bf.New(r.CreateElement("button"),b3,be.TextNode(bZ));};be.Button=function(bZ,b0,b1){var b2;b2=_1.Concat(b0);return bf.New(be.Clickable("button",b1),b2,be.TextNode(bZ));};be.Clickable=function(bZ,b0){var b1;b1=r.CreateElement(bZ);b1.addEventListener("click",function(b2){b2.preventDefault();return b0();},false);return b1;};be.CheckBoxGroup=function(bZ,b0,b1){function b2(b3){return bH.Equals(b0,b3);}return be.CheckBox(bZ,x.Lens(b1,function(b3){return bx.exists(b2,b3);},function(b3,b4){return b4?bx.exists(function(b5){return bH.Equals(b0,b5);},b3)?b3:new bx.T({$:1,$0:b0,$1:b3}):bx.filter(function(b5){return!bH.Equals(b0,b5);},b3);}));};be.CheckBox=function(bZ,b0){return be.InputInternal("input",function(){return bE.append(bZ,[_1.Create("type","checkbox"),_7.Checked(b0)]);});};be.SelectDynOptional=function(bZ,b0,b1,b2,b3){return be.SelectDyn(bZ,function(b4){return b4!=null&&b4.$==1?b1(b4.$0):b0;},y.Map(function(b4){return new bx.T({$:1,$0:null,$1:bx.map(function(b5){return{$:1,$0:b5};},b4)});},b2),b3);};be.SelectOptional=function(bZ,b0,b1,b2,b3){return be.Select(bZ,function(b4){return b4!=null&&b4.$==1?b1(b4.$0):b0;},new bx.T({$:1,$0:null,$1:bx.map(function(b4){return{$:1,$0:b4};},b2)}),b3);};be.Select=function(bZ,b0,b1,b2){return be.SelectImpl(bZ,b0,function(b3){b3[0]=b1;return be.Concat(bx.mapi(function(b4,b5){return be.Element("option",bx.ofArray([_1.Create("value",a.String(b4))]),bx.ofArray([be.TextNode(b0(b5))]));},b1));},b2);};be.SelectDyn=function(bZ,b0,b1,b2){return be.SelectImpl(bZ,b0,function(b3){function b4(b5,b6){return be.Element("option",bx.ofArray([_1.Create("value",a.String(b5))]),bx.ofArray([be.TextNode(b0(b6))]));}return be.Convert(function(b5){return b4(b5[0],b5[1]);},y.Map(function(b5){b3[0]=b5;return bE.mapi(function(b6,b7){return[b6,b7];},b5);},b1));},b2);};be.SelectImpl=function(bZ,b0,b1,b2){var b3,b4,b5,b6;function b7(ca){return ca.selectedIndex;}function b8(ca,cb){ca.selectedIndex=cb;}function b9(ca){var cb;cb=b7(ca);return b3[0].get_Item(cb);}function b_(ca){return bE.findIndex(function(cb){return bH.Equals(ca,cb);},b3[0]);}function b$(ca,cb){return b8(ca,b_(cb));}b3=[bx.T.Empty];b4=r.CreateElement("select");b5=_7.DynamicCustom(function(ca){return function(cb){return b$(ca,cb);};},b2.get_View());b4.addEventListener("change",function(){b2.UpdateMaybe(function(ca){var cb;cb=b9(b4);return bH.Equals(ca,cb)?null:{$:1,$0:cb};});},false);return bf.New(b4,(b6=_1.Append(b5,_1.Concat(bZ)),_1.Append(_7.OnAfterRender(function(ca){b$(ca,b2.Get());}),b6)),b1(b3));};be.InputArea=function(bZ,b0){return be.InputInternal("textarea",function(){return bE.append(bZ,[_7.Value(b0)]);});};be.FloatInput=function(bZ,b0){return be.InputInternal("input",function(){return bE.append(bZ,[_7.FloatValue(b0),_1.Create("type","number")]);});};be.FloatInputUnchecked=function(bZ,b0){return be.InputInternal("input",function(){return bE.append(bZ,[b0.Get()===0?_1.Create("value","0"):_5.EmptyAttr(),_7.FloatValueUnchecked(b0),_1.Create("type","number")]);});};be.IntInput=function(bZ,b0){return be.InputInternal("input",function(){return bE.append(bZ,[_7.IntValue(b0),_1.Create("type","number")]);});};be.IntInputUnchecked=function(bZ,b0){return be.InputInternal("input",function(){return bE.append(bZ,[b0.Get()===0?_1.Create("value","0"):_5.EmptyAttr(),_7.IntValueUnchecked(b0),_1.Create("type","number")]);});};be.PasswordBox=function(bZ,b0){return be.InputInternal("input",function(){return bE.append(bZ,[_7.Value(b0),_1.Create("type","password")]);});};be.Input=function(bZ,b0){return be.InputInternal("input",function(){return bE.append(bZ,[_7.Value(b0)]);});};be.InputInternal=function(bZ,b0){var b1;b1=r.CreateElement(bZ);return bf.New(b1,_1.Concat(b0(b1)),be.Empty());};be.ConvertSeqVarBy=function(bZ,b0,b1){return be.Flatten(x.MapLens(bZ,b0,b1));};be.ConvertSeqBy=function(bZ,b0,b1){return be.Flatten(y.MapSeqCachedViewBy(bZ,function(b2,b3){return(b0(b2))(b3);},b1));};be.ConvertSeq=function(bZ,b0){return be.Flatten(y.MapSeqCachedView(bZ,b0));};be.ConvertBy=function(bZ,b0,b1){return be.Flatten(y.MapSeqCachedBy(bZ,b0,b1));};be.Convert=function(bZ,b0){return be.Flatten(y.MapSeqCached(bZ,b0));};be.Flatten=function(bZ){return be.EmbedView(y.Map(be.Concat,bZ));};be.GetOrLoadTemplate=function(bZ,b0,b1,b2){be.LoadLocalTemplates$1();be.PrepareTemplate(bZ,b0,b1);return be.NamedTemplate(bZ,b0,b2);};be.NamedTemplate=function(bZ,b0,b1){var b2,b3;b2=(b3=null,[bd.LoadedTemplateFile(bZ).TryGetValue(b0==null?"":b0.$0,{get:function(){return b3;},set:function(b4){b3=b4;}}),b3]);return b2[0]?be.ChildrenTemplate(b2[1].cloneNode(true),b1):(bI.warn("Local template doesn't exist",b0),be.Empty());};be.LoadLocalTemplates=function(bZ){var b0;b0=bd.LoadedTemplateFile("");b0.count>0?bd.LoadedTemplates().set_Item(bZ,b0):(function(){var b1,b2,b3,b4;while(true){b1=a.document.querySelector("[ws-template]");if(bH.Equals(b1,null)){b2=a.document.querySelector("[ws-children-template]");if(bH.Equals(b2,null))return null;else{b3=b2.getAttribute("ws-children-template");b2.removeAttribute("ws-children-template");be.PrepareTemplate(bZ,{$:1,$0:b3},function(b5){return function(){return r.ChildrenArray(b5);};}(b2));}}else{b4=b1.getAttribute("ws-template");be.PrepareSingleTemplate(bZ,{$:1,$0:b4},b1);}}}(),bd.LoadedTemplates().set_Item("",bd.LoadedTemplateFile(bZ)));};be.LoadLocalTemplates$1=function(){if(!bd.LocalTemplatesLoaded()){bd.set_LocalTemplatesLoaded(true);be.LoadLocalTemplates("");}};be.PrepareTemplate=function(bZ,b0,b1){var b2,b3,b4,b5,b6;if(!bd.LoadedTemplateFile(bZ).ContainsKey(b0==null?"":b0.$0)){b2=b1();for(b3=0,b4=b2.length-1;b3<=b4;b3++){b5=by.get(b2,b3);b6=b5.parentNode;bH.Equals(b6,null)?void 0:b6.removeChild(b5);}be.PrepareTemplateStrict(bZ,b0,b2,null);}};be.PrepareTemplateStrict=function(bZ,b0,b1,b2){var b3,b4;function b5(cf){var ch,ci,cj,ck,cl,cm,cn,co;function cg(cp){var cq;cq=cf.getAttribute(cp);cq===null?void 0:cf.setAttribute(cp,cq.toLowerCase());}ch=cf.attributes;ci=[];cj=[];ck=[];for(cl=0,cm=ch.length-1;cl<=cm;cl++){cn=ch.item(cl);bA.StartsWith(cn.nodeName,"ws-on")&&cn.nodeName!=="ws-onafterrender"&&cn.nodeName!=="ws-on"?(ci.push(cn.nodeName),cj.push(bU.string(cn.nodeName,{$:1,$0:"ws-on".length},null)+":"+cn.nodeValue.toLowerCase())):!bA.StartsWith(cn.nodeName,"ws-")&&(new a.RegExp(bd.TextHoleRE())).test(cn.nodeValue)?(cn.nodeValue=(co=new a.RegExp(bd.TextHoleRE(),"g"),cn.nodeValue.replace(co,function(cp,cq){return"${"+cq.toLowerCase()+"}";})),ck.push(cn.nodeName)):void 0;}!(cj.length==0)?cf.setAttribute("ws-on",bA.concat(" ",cj)):void 0;!(ck.length==0)?cf.setAttribute("ws-attr-holes",bA.concat(" ",ck)):void 0;cg("ws-hole");cg("ws-replace");cg("ws-attr");cg("ws-onafterrender");cg("ws-var");by.iter(function(cp){cf.removeAttribute(cp);},ci);}function b6(cf){var cg,ch,ci,cj,ck,cl;cg=null;ch=0;cj=cf.textContent;ck=new a.RegExp(bd.TextHoleRE(),"g");while(cg=ck.exec(cj),cg!==null){cf.parentNode.insertBefore(a.document.createTextNode(bU.string(cj,{$:1,$0:ch},{$:1,$0:ck.lastIndex-by.get(cg,0).length-1})),cf);ch=ck.lastIndex;cl=a.document.createElement("span");cl.setAttribute("ws-replace",by.get(cg,1).toLowerCase());cf.parentNode.insertBefore(cl,cf);}ck.lastIndex=0;cf.textContent=bU.string(cj,{$:1,$0:ch},null);}function b7(cf,cg){function ch(ci){r.IterSelector(cf,"["+ci+"]",function(cj){var ck,cl;ck=(cl=null,[cg.TryGetValue(cj.getAttribute(ci).toLowerCase(),{get:function(){return cl;},set:function(cm){cl=cm;}}),cl]);ck[0]?cj.setAttribute(ci,ck[1]):void 0;});}ch("ws-hole");ch("ws-replace");ch("ws-attr");ch("ws-onafterrender");ch("ws-var");r.IterSelector(cf,"[ws-on]",function(ci){ci.setAttribute("ws-on",bA.concat(" ",by.map(function(cj){var ck,cl,cm;ck=bA.SplitChars(cj,[":"],1);cl=(cm=null,[cg.TryGetValue(by.get(ck,1),{get:function(){return cm;},set:function(cn){cm=cn;}}),cm]);return cl[0]?by.get(ck,0)+":"+cl[1]:cj;},bA.SplitChars(ci.getAttribute("ws-on"),[" "],1))));});return r.IterSelector(cf,"[ws-attr-holes]",function(ci){var cj,ck,cl;cj=bA.SplitChars(ci.getAttribute("ws-attr-holes"),[" "],1);for(ck=0,cl=cj.length-1;ck<=cl;ck++)(function(){var cm;function cn(co,cp){var cq;cq=bM.KeyValue(cp);return co.replace(new a.RegExp("\\${"+cq[0]+"}","ig"),"${"+cq[1]+"}");}cm=by.get(cj,ck);return ci.setAttribute(cm,(((bG.Curried3(bE.fold))(cn))(ci.getAttribute(cm)))(cg));}());});}function b8(cf,cg){var ch,ci,cj,ck,cl;b5(cg);ch=cg.nodeName.toLowerCase();ci=cf.querySelector("[ws-attr="+ch+"]");if(bH.Equals(ci,null))return bI.warn("Filling non-existent attr hole",ch);else{ci.removeAttribute("ws-attr");for(cj=0,ck=cg.attributes.length-1;cj<=ck;cj++){cl=cg.attributes.item(cj);cl.name==="class"&&ci.hasAttribute("class")?ci.setAttribute("class",ci.getAttribute("class")+" "+cl.nodeValue):ci.setAttribute(cl.name,cl.nodeValue);}return;}}function b9(cf,cg){function ch(ci){r.IterSelector(cf,"["+ci+"]",function(cj){if(!cg.Contains(cj.getAttribute(ci)))cj.removeAttribute(ci);});}ch("ws-attr");ch("ws-onafterrender");ch("ws-var");r.IterSelector(cf,"[ws-hole]",function(ci){if(!cg.Contains(ci.getAttribute("ws-hole"))){ci.removeAttribute("ws-hole");while(ci.hasChildNodes())ci.removeChild(ci.lastChild);}});r.IterSelector(cf,"[ws-replace]",function(ci){if(!cg.Contains(ci.getAttribute("ws-replace")))ci.parentNode.removeChild(ci);});r.IterSelector(cf,"[ws-on]",function(ci){ci.setAttribute("ws-on",bA.concat(" ",by.filter(function(cj){return cg.Contains(by.get(bA.SplitChars(cj,[":"],1),1));},bA.SplitChars(ci.getAttribute("ws-on"),[" "],1))));});return r.IterSelector(cf,"[ws-attr-holes]",function(ci){var cj,ck,cl,cm,cn;cj=bA.SplitChars(ci.getAttribute("ws-attr-holes"),[" "],1);for(ck=0,cl=cj.length-1;ck<=cl;ck++){cm=by.get(cj,ck);ci.setAttribute(cm,(cn=new a.RegExp(bd.TextHoleRE(),"g"),ci.getAttribute(cm).replace(cn,function(co,cp){return cg.Contains(cp)?co:"";})));}});}function b_(cf,cg){var ch;ch=cf.querySelector("[ws-replace]");return bH.Equals(ch,null)?(bI.warn("Filling non-existent text hole",b0),null):(ch.parentNode.replaceChild(new a.Text(cg),ch),{$:1,$0:ch.getAttribute("ws-replace")});}function b$(cf,cg,ch){while(true)if(cf.hasChildNodes())ch=cg.insertBefore(cf.lastChild,ch);else return null;}function ca(cf,cg,ch){var ci,cj,ck,cl,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI;function cm(cJ){}while(true)switch(cf){case 0:cn=bU.string(cg.nodeName,{$:1,$0:3},null).toLowerCase();co=(ci=cn.indexOf("."),ci===-1?[bZ,cn]:[bU.string(cn,null,{$:1,$0:ci-1}),bU.string(cn,{$:1,$0:ci+1},null)]);cp=co[1];cq=co[0];if(!bd.LoadedTemplates().ContainsKey(cq))return bI.warn("Instantiating non-loaded template",cp);else{cr=bd.LoadedTemplates().get_Item(cq);if(!cr.ContainsKey(cp))return bI.warn("Instantiating non-loaded template",cp);else{cs=cr.get_Item(cp);ct=cs.cloneNode(true);cu=new bD.New$3();cv=new bP.New$5();cw=cg.attributes;for(cx=0,cy=cw.length-1;cx<=cy;cx++){cz=cw.item(cx).name.toLowerCase();cv.set_Item(cz,(cA=cw.item(cx).nodeValue,cA===""?cz:cA.toLowerCase()));!cu.Add(cz)?bI.warn("Hole mapped twice",cz):void 0;}for(cB=0,cC=cg.childNodes.length-1;cB<=cC;cB++){cD=cg.childNodes[cB];bH.Equals(cD.nodeType,bS.ELEMENT_NODE)?!cu.Add(cD.nodeName.toLowerCase())?bI.warn("Hole filled twice",cp):void 0:void 0;}cE=cg.childNodes.length===1&&bH.Equals(cg.firstChild.nodeType,bS.TEXT_NODE);if(cE){ck=b_(ct,cg.firstChild.textContent);((function(cJ){return function(cK){if(cK!=null)cJ(cK.$0);};}((cl=function(cJ){return function(cK){return cJ.Add(cK);};}(cu),function(cJ){return cm(cl(cJ));})))(ck));}b9(ct,cu);if(!cE){for(cF=0,cG=cg.childNodes.length-1;cF<=cG;cF++){cH=cg.childNodes[cF];bH.Equals(cH.nodeType,bS.ELEMENT_NODE)?cH.hasAttributes()?b8(ct,cH):cb(ct,cH):void 0;}}b7(ct,cv);(((function(cJ){function cK(cL,cM){return b$(cJ,cL,cM);}return function(cL){return function(cM){return cK(cL,cM);};};}(ct))(cg.parentNode))(cg));cg.parentNode.removeChild(cg);return;}}break;case 1:if(ch!==null){cI=ch.nextSibling;if(bH.Equals(ch.nodeType,bS.TEXT_NODE))b6(ch);else if(bH.Equals(ch.nodeType,bS.ELEMENT_NODE))cd(ch);ch=cI;}else return null;break;}}function cb(cf,cg){var ch,cj,ck;function ci(cl,cm){var cn,co,cp;if(cj==="title"&&cg.hasChildNodes()){cn=bT.parseHTML(cg.textContent);cg.removeChild(cg.firstChild);for(co=0,cp=cn.length-1;co<=cp;co++)cg.appendChild(by.get(cn,co));}else null;cd(cg);return b$(cg,cl,cm);}cj=cg.nodeName.toLowerCase();r.IterSelector(cf,"[ws-attr-holes]",function(cl){var cm,cn,co,cp,cq;cm=bA.SplitChars(cl.getAttribute("ws-attr-holes"),[" "],1);for(cn=0,co=cm.length-1;cn<=co;cn++){cp=by.get(cm,cn);cl.setAttribute(cp,(cq=new a.RegExp("\\${"+cj+"}","ig"),cl.getAttribute(cp).replace(cq,cg.textContent)));}});ck=cf.querySelector("[ws-hole="+cj+"]");if(bH.Equals(ck,null)){ch=cf.querySelector("[ws-replace="+cj+"]");return bH.Equals(ch,null)?null:(ci(ch.parentNode,ch),void ch.parentNode.removeChild(ch));}else{while(ck.hasChildNodes())ck.removeChild(ck.lastChild);ck.removeAttribute("ws-hole");return ci(ck,null);}}function cc(cf){return ca(0,cf);}function cd(cf){var cg,ch;if(bA.StartsWith(cf.nodeName.toLowerCase(),"ws-")&&!cf.hasAttribute("ws-template"))cc(cf);else{b5(cf);cg=cf.getAttribute("ws-template");if(cg===null){ch=cf.getAttribute("ws-children-template");if(ch===null)ce(cf,cf.firstChild);else{cf.removeAttribute("ws-children-template");be.PrepareTemplate(bZ,{$:1,$0:ch},function(){return r.ChildrenArray(cf);});while(cf.hasChildNodes())cf.removeChild(cf.lastChild);}}else be.PrepareSingleTemplate(bZ,{$:1,$0:cg},cf);}}function ce(cf,cg){return ca(1,cf,cg);}b3=b2!=null&&b2.$==1?b2.$0:be.FakeRoot(b1);b4=(b0==null?"":b0.$0).toLowerCase();bd.LoadedTemplateFile(bZ).set_Item(b4,b3);by.length(b1)>0?ce(b3,by.get(b1,0)):void 0;};be.PrepareSingleTemplate=function(bZ,b0,b1){var b2,b3,b4;b1.removeAttribute("ws-template");b2=b1.getAttribute("ws-replace");b2===null?void 0:(b1.removeAttribute("ws-replace"),b3=b1.parentNode,bH.Equals(b3,null)?void 0:(b4=a.document.createElement(b1.tagName),b4.setAttribute("ws-replace",b2),b3.replaceChild(b4,b1)));be.PrepareTemplateStrict(bZ,b0,[b1],null);};be.FakeRoot=function(bZ){var b0,b1,b2;b0=a.document.createElement("div");for(b1=0,b2=bZ.length-1;b1<=b2;b1++)b0.appendChild(by.get(bZ,b1));return b0;};be.RunFullDocTemplate=function(bZ){var b0,b1;be.PrepareTemplateStrict("",null,r.ChildrenArray(a.document.body),{$:1,$0:a.document.body});b0=be.ChildrenTemplate(a.document.body,bZ);b1=a.document.body;(function(b2){be.RunInPlace(true,b1,b2);}(b0));return b0;};be.ChildrenTemplate=function(bZ,b0){var b1,b2,b3,b4,b5;b1=be.InlineTemplate(bZ,b0);b2=b1[1];b3=b1[0];b4=b3.Els;return!bH.Equals(b4,null)&&b4.length===1&&(by.get(b4,0)instanceof bS&&(bH.Equals(by.get(b4,0).nodeType,bS.ELEMENT_NODE)&&(b5=by.get(b4,0),true)))?bf.TreeNode(b3,b2):be.Mk({$:6,$0:b3},b2);};be.InlineTemplate=function(bZ,b0){var b1,b2,b5,b6,b7,b8,b9,b_,b$;function b3(ca,cb){var cc,cd,ce;cc=_5.Insert(ca,cb);b6.push(_5.Updates(cc));b7.push([ca,cc]);cd=bG.GetOptional(cc.OnAfterRender);return cd==null?null:(ce=cd.$0,void b8.push(function(){ce(ca);}));}function b4(ca){var cb,cc;cb=(cc=null,[b9.TryGetValue(ca,{get:function(){return cc;},set:function(cd){cc=cd;}}),cc]);return cb[0]?cb[1].$==0?{$:1,$0:cb[1].$1}:cb[1].$==1?{$:1,$0:be.TextNode(cb[1].$1)}:cb[1].$==2?{$:1,$0:be.TextView(cb[1].$1)}:cb[1].$==8?{$:1,$0:be.TextView(cb[1].$1.get_View())}:cb[1].$==9?{$:1,$0:be.TextView(y.Map(a.String,cb[1].$1.get_View()))}:cb[1].$==10?{$:1,$0:be.TextView(y.Map(function(cd){return cd.get_Input();},cb[1].$1.get_View()))}:cb[1].$==11?{$:1,$0:be.TextView(y.Map(a.String,cb[1].$1.get_View()))}:cb[1].$==12?{$:1,$0:be.TextView(y.Map(function(cd){return cd.get_Input();},cb[1].$1.get_View()))}:cb[1].$==13?{$:1,$0:be.TextView(y.Map(a.String,cb[1].$1.get_View()))}:(bI.warn("Content hole filled with attribute data",ca),null):null;}b5=[];b6=[];b7=[];b8=[];b9=new bP.New$5();b_=bz.Get(b0);try{while(b_.MoveNext()){b$=b_.Current();b9.set_Item(b$.$0,b$);}}finally{if("Dispose"in b_)b_.Dispose();}b1=r.ChildrenArray(bZ);r.IterSelector(bZ,"[ws-hole]",function(ca){var cb,cc,cd;cd=ca.getAttribute("ws-hole");ca.removeAttribute("ws-hole");while(ca.hasChildNodes())ca.removeChild(ca.lastChild);cb=b4(cd);cb!=null&&cb.$==1?(cc=cb.$0,bd.LinkElement(ca,cc.docNode),b5.push(_.New(_5.Empty(ca),cc.docNode,null,ca,h.Int(),null)),b6.push(cc.updates)):void 0;});r.IterSelector(bZ,"[ws-replace]",function(ca){var cb,cc,cd,ce,cf,cg;cb=b4(ca.getAttribute("ws-replace"));cb!=null&&cb.$==1?(cc=cb.$0,cd=ca.parentNode,ce=a.document.createTextNode(""),cd.replaceChild(ce,ca),cf=bd.InsertBeforeDelim(ce,cc.docNode),cg=by.tryFindIndex(function(ch){return ca===ch;},b1),cg==null?void 0:by.set(b1,cg.$0,cc.docNode),b5.push(_.New(_5.Empty(cd),cc.docNode,{$:1,$0:[cf,ce]},cd,h.Int(),null)),b6.push(cc.updates)):void 0;});r.IterSelector(bZ,"[ws-attr]",function(ca){var cb,cc,cd;cb=ca.getAttribute("ws-attr");ca.removeAttribute("ws-attr");cc=(cd=null,[b9.TryGetValue(cb,{get:function(){return cd;},set:function(ce){cd=ce;}}),cd]);cc[0]?cc[1].$==3?b3(ca,cc[1].$1):bI.warn("Attribute hole filled with non-attribute data",cb):void 0;});r.IterSelector(bZ,"[ws-on]",function(ca){b3(ca,_1.Concat(by.choose(function(cb){var cc,cd,ce;cc=bA.SplitChars(cb,[":"],1);cd=(ce=null,[b9.TryGetValue(by.get(cc,1),{get:function(){return ce;},set:function(cf){ce=cf;}}),ce]);return cd[0]?cd[1].$==4?{$:1,$0:_7.Handler(by.get(cc,0),cd[1].$1)}:cd[1].$==5?{$:1,$0:_1.Handler(by.get(cc,0),cd[1].$2)}:(bI.warn("Event hole on"+by.get(cc,0)+" filled with non-event data",by.get(cc,1)),null):null;},bA.SplitChars(ca.getAttribute("ws-on"),[" "],1))));ca.removeAttribute("ws-on");});r.IterSelector(bZ,"[ws-onafterrender]",function(ca){var cb,cc,cd;cb=ca.getAttribute("ws-onafterrender");cc=(cd=null,[b9.TryGetValue(cb,{get:function(){return cd;},set:function(ce){cd=ce;}}),cd]);cc[0]?cc[1].$==6?(ca.removeAttribute("ws-onafterrender"),b3(ca,_7.OnAfterRender(cc[1].$1))):cc[1].$==7?(ca.removeAttribute("ws-onafterrender"),b3(ca,_7.OnAfterRender(cc[1].$1))):bI.warn("onafterrender hole filled with non-onafterrender data",cb):void 0;});r.IterSelector(bZ,"[ws-var]",function(ca){var cb,cc,cd;cb=ca.getAttribute("ws-var");ca.removeAttribute("ws-var");cc=(cd=null,[b9.TryGetValue(cb,{get:function(){return cd;},set:function(ce){cd=ce;}}),cd]);cc[0]?cc[1].$==8?b3(ca,_7.Value(cc[1].$1)):cc[1].$==9?b3(ca,_7.Checked(cc[1].$1)):cc[1].$==10?b3(ca,_7.IntValue(cc[1].$1)):cc[1].$==11?b3(ca,_7.IntValueUnchecked(cc[1].$1)):cc[1].$==12?b3(ca,_7.FloatValue(cc[1].$1)):cc[1].$==13?b3(ca,_7.FloatValueUnchecked(cc[1].$1)):bI.warn("Var hole filled with non-Var data",cb):void 0;});r.IterSelector(bZ,"[ws-attr-holes]",function(ca){var cb,cc,cd,ce;cb=new a.RegExp(bd.TextHoleRE(),"g");cc=bA.SplitChars(ca.getAttribute("ws-attr-holes"),[" "],1);ca.removeAttribute("ws-attr-holes");for(cd=0,ce=cc.length-1;cd<=ce;cd++)(function(){var cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr;co=by.get(cc,cd);cp=ca.getAttribute(co);cf=null;cg=0;cq=[];while(cf=cb.exec(cp),cf!==null){cr=bU.string(cp,{$:1,$0:cg},{$:1,$0:cb.lastIndex-by.get(cf,0).length-1});cg=cb.lastIndex;cq.push([cr,by.get(cf,1)]);}ci=bU.string(cp,{$:1,$0:cg},null);cb.lastIndex=0;cj=by.foldBack(function(cs,ct){return(function(cu){var cv,cw;cv=cu[0];cw=cu[1];return function(cx){var cy,cz,cA,cB,cC;cy=cx[0];cz=cx[1];cA=(cB=(cC=null,[b9.TryGetValue(cw,{get:function(){return cC;},set:function(cD){cC=cD;}}),cC]),cB[0]?cB[1].$==1?{$:0,$0:cB[1].$1}:cB[1].$==2?{$:1,$0:cB[1].$1}:cB[1].$==8?{$:1,$0:cB[1].$1.get_View()}:cB[1].$==9?{$:1,$0:y.Map(a.String,cB[1].$1.get_View())}:cB[1].$==10?{$:1,$0:y.Map(function(cD){return cD.get_Input();},cB[1].$1.get_View())}:cB[1].$==11?{$:1,$0:y.Map(a.String,cB[1].$1.get_View())}:cB[1].$==12?{$:1,$0:y.Map(function(cD){return cD.get_Input();},cB[1].$1.get_View())}:cB[1].$==13?{$:1,$0:y.Map(a.String,cB[1].$1.get_View())}:(bI.warn("Attribute value hole filled with non-text data",cw),{$:0,$0:""}):{$:0,$0:""});return cA.$==1?[cv,new bx.T({$:1,$0:cy===""?cA.$0:y.Map(function(cD){return cD+cy;},cA.$0),$1:cz})]:[cv+cA.$0+cy,cz];};}(cs))(ct);},cq,[ci,bx.T.Empty]);return b3(ca,cj[1].$==1?cj[1].$1.$==1?cj[1].$1.$1.$==1?cj[1].$1.$1.$1.$==0?(ck=cj[0],_7.Dynamic(co,y.Map3(function(cs,ct,cu){return ck+cs+ct+cu;},cj[1].$0,cj[1].$1.$0,cj[1].$1.$1.$0))):(cl=cj[0],_7.Dynamic(co,y.Map(function(cs){return cl+bA.concat("",cs);},y.Sequence(cj[1])))):(cm=cj[0],_7.Dynamic(co,y.Map2(function(cs,ct){return cm+cs+ct;},cj[1].$0,cj[1].$1.$0))):cj[0]===""?_7.Dynamic(co,cj[1].$0):(cn=cj[0],_7.Dynamic(co,y.Map(function(cs){return cn+cs;},cj[1].$0))):_1.Create(co,cj[0]));}());});return[bG.DeleteEmptyFields({Els:b1,Dirty:true,Holes:b5,Attrs:b7,Render:(b2=b8.length==0?null:{$:1,$0:function(ca){by.iter(function(cb){cb(ca);},b8);}},b2?b2.$0:void 0)},["Render"]),d.TreeReduce(y.Const(),y.Map2Unit,b6)];};be.Template=function(bZ,b0){return be.ChildrenTemplate(be.FakeRoot(bZ),b0);};be.TextView=function(bZ){var b0;b0=bd.CreateTextNode();return be.Mk({$:4,$0:b0},y.Map(function(b1){bd.UpdateTextNode(b0,b1);},bZ));};be.RunReplaceById=function(bZ,b0){var b1;b1=r.Doc().getElementById(bZ);bH.Equals(b1,null)?bM.FailWith("invalid id: "+bZ):b0.ReplaceInDom(b1);};be.RunById=function(bZ,b0){var b1;b1=r.Doc().getElementById(bZ);bH.Equals(b1,null)?bM.FailWith("invalid id: "+bZ):be.Run(b1,b0);};be.Run=function(bZ,b0){be.LoadLocalTemplates$1();bd.LinkElement(bZ,b0.docNode);be.RunInPlace(false,bZ,b0);};be.RunInPlace=function(bZ,b0,b1){var b2;b2=bd.CreateRunState(b0,b1.docNode);y.Sink(S.get_UseAnimations()||_9.BatchUpdatesEnabled()?n.StartProcessor(bd.PerformAnimatedUpdate(bZ,b2,b1.docNode)):function(){bd.PerformSyncUpdate(bZ,b2,b1.docNode);},b1.updates);};be.RunPrependById=function(bZ,b0){var b1;b1=r.Doc().getElementById(bZ);bH.Equals(b1,null)?bM.FailWith("invalid id: "+bZ):be.RunPrepend(b1,b0);};be.RunPrepend=function(bZ,b0){var b1;b1=a.document.createTextNode("");bZ.insertBefore(b1,bZ.firstChild);be.RunBefore(b1,b0);};be.RunAppendById=function(bZ,b0){var b1;b1=r.Doc().getElementById(bZ);bH.Equals(b1,null)?bM.FailWith("invalid id: "+bZ):be.RunAppend(b1,b0);};be.RunAppend=function(bZ,b0){var b1;b1=a.document.createTextNode("");bZ.appendChild(b1);be.RunBefore(b1,b0);};be.RunAfterById=function(bZ,b0){var b1;b1=r.Doc().getElementById(bZ);bH.Equals(b1,null)?bM.FailWith("invalid id: "+bZ):be.RunAfter(b1,b0);};be.RunAfter=function(bZ,b0){var b1;b1=a.document.createTextNode("");bZ.parentNode.insertBefore(b1,bZ.nextSibling);be.RunBetween(bZ,b1,b0);};be.RunBeforeById=function(bZ,b0){var b1;b1=r.Doc().getElementById(bZ);bH.Equals(b1,null)?bM.FailWith("invalid id: "+bZ):be.RunBefore(b1,b0);};be.RunBefore=function(bZ,b0){var b1;b1=a.document.createTextNode("");bZ.parentNode.insertBefore(b1,bZ);be.RunBetween(b1,bZ,b0);};be.RunBetween=function(bZ,b0,b1){var b2;bd.LinkPrevElement(b0,b1.docNode);b2=bd.CreateDelimitedRunState(bZ,b0,b1.docNode);y.Sink(S.get_UseAnimations()||_9.BatchUpdatesEnabled()?n.StartProcessor(bd.PerformAnimatedUpdate(false,b2,b1.docNode)):function(){bd.PerformSyncUpdate(false,b2,b1.docNode);},b1.updates);};be.Async=function(bZ){return be.EmbedView(y.MapAsync(a.id,y.Const(bZ)));};be.BindView=function(bZ,b0){return be.EmbedView(y.Map(bZ,b0));};be.EmbedView=function(bZ){var b0;b0=bd.CreateEmbedNode();return be.Mk({$:2,$0:b0},y.Map(a.ignore,y.Bind(function(b1){bd.UpdateEmbedNode(b0,b1.docNode);return b1.updates;},bZ)));};be.Static=function(bZ){return bf.New(bZ,_5.EmptyAttr(),be.Empty());};be.Mk=function(bZ,b0){return new be.New(bZ,b0);};be.New=bG.Ctor(function(bZ,b0){this.docNode=bZ;this.updates=b0;},be);bf=c.Elt=bG.Class({AddClass:function(bZ){return this.elt.className+=" "+bZ;},ClearHoles:function(){var bZ;bZ=this.docNode$1;bZ!=null&&bZ.$==6?bZ.$0.Holes=[]:void 0;},AddHole:function(bZ){var b0;b0=this.docNode$1;b0!=null&&b0.$==6?b0.$0.Holes.push(bZ):void 0;},SetStyle:function(bZ,b0){this.elt.style[bZ]=b0;},HasClass:function(bZ){return(new a.RegExp("(\\s|^)"+bZ+"(\\s|$)")).test(this.elt.className);},RemoveClass:function(bZ){this.elt.className=this.elt.className.replace(new a.RegExp("(?:(\\s|^)"+bZ+")+(\\s|$)","g"),"$1");},GetProperty:function(bZ){return this.elt[bZ];},SetProperty:function(bZ,b0){this.elt[bZ]=b0;},RemoveAttribute:function(bZ){this.elt.removeAttribute(bZ);},HasAttribute:function(bZ){return this.elt.hasAttribute(bZ);},GetAttribute:function(bZ){return this.elt.getAttribute(bZ);},SetAttribute:function(bZ,b0){this.elt.setAttribute(bZ,b0);},SetText:function(bZ){var b0;b0=this.docNode$1;b0!=null&&b0.$==1?b0.$0.Children=null:b0!=null&&b0.$==6?(b0.$0.Els=[],this.ClearHoles()):bM.FailWith("Invalid docNode in Elt");this.rvUpdates.set_Value(y.Const());this.elt.textContent=bZ;},GetText:function(){return this.elt.textContent;},SetValue:function(bZ){this.elt.value=bZ;},GetValue:function(){return this.elt.value;},Id:function(){return this.elt.id;},Html:function(){return this.elt.outerHTML;},Clear:function(){var bZ;bZ=this.docNode$1;bZ!=null&&bZ.$==1?bZ.$0.Children=null:bZ!=null&&bZ.$==6?(bZ.$0.Els=[],this.ClearHoles()):bM.FailWith("Invalid docNode in Elt");this.rvUpdates.set_Value(y.Const());while(this.elt.hasChildNodes())this.elt.removeChild(this.elt.firstChild);},Prepend:function(bZ){var b0,b1,b2,b3,b4;b0=this.docNode$1;b0!=null&&b0.$==1?(b1=b0.$0,b1.Children={$:0,$0:bZ.docNode,$1:b1.Children},bd.InsertDoc(this.elt,bZ.docNode,(b2=this.elt.firstChild,bH.Equals(b2,null)?null:b2))):b0!=null&&b0.$==6?(b3=this.elt.insertBefore(a.document.createTextNode(""),this.elt.firstChild),b4=bd.InsertBeforeDelim(b3,bZ.docNode),this.AddHole(_.New(_5.Empty(this.elt),bZ.docNode,{$:1,$0:[b4,b3]},this.elt,h.Int(),null))):bM.FailWith("Invalid docNode in Elt");this.rvUpdates.set_Value(y.Map2Unit(this.rvUpdates.c,bZ.updates));},Append:function(bZ){var b0,b1,b2,b3;b0=this.docNode$1;b0!=null&&b0.$==1?(b1=b0.$0,b1.Children={$:0,$0:b1.Children,$1:bZ.docNode},bd.InsertDoc(this.elt,bZ.docNode,null)):b0!=null&&b0.$==6?(b2=this.elt.appendChild(a.document.createTextNode("")),b3=bd.InsertBeforeDelim(b2,bZ.docNode),this.AddHole(_.New(_5.Empty(this.elt),bZ.docNode,{$:1,$0:[b3,b2]},this.elt,h.Int(),null))):bM.FailWith("Invalid docNode in Elt");this.rvUpdates.set_Value(y.Map2Unit(this.rvUpdates.c,bZ.updates));},ToUpdater:function(){var bZ,b0;return new bg.New((bZ=this.docNode$1,bZ!=null&&bZ.$==1?bG.DeleteEmptyFields({Els:[this.elt],Dirty:true,Holes:[],Attrs:[[this.elt,bZ.$0.Attr]],Render:(b0=null,b0?b0.$0:void 0)},["Render"]):bZ!=null&&bZ.$==6?bZ.$0:bM.FailWith("Invalid docNode in Elt")),this.updates$1,this.elt,this.rvUpdates,x.Create$1([]));},OnAfterRenderView:function(bZ,b0){var b1,b2;b1=this;b2=h.Id();this.Append(be.BindView(function(b3){b1.elt[b2]=b3;return be.Empty();},bZ));return this.OnAfterRender$1(function(b3){b0(b3,b3[b2]);});},OnAfterRender:function(bZ){return this.OnAfterRender$1(bZ);},OnAfterRender$1:function(bZ){var b0,b1,b2,b3,b4,b5,b6;b0=this.docNode$1;b0!=null&&b0.$==1?(b1=b0.$0,bG.SetOptional(b1,"Render",(b2=bG.GetOptional(b1.Render),b2!=null&&b2.$==1?(b3=b2.$0,{$:1,$0:function(b7){b3(b7);bZ(b7);}}):{$:1,$0:bZ}))):b0!=null&&b0.$==6?(b4=b0.$0,bG.SetOptional(b4,"Render",(b5=bG.GetOptional(b4.Render),b5!=null&&b5.$==1?(b6=b5.$0,{$:1,$0:function(b7){b6(b7);bZ(b7);}}):{$:1,$0:bZ}))):bM.FailWith("Invalid docNode in Elt");return this;},onView:function(bZ,b0,b1){var b2;b2=b1(this.elt);this.elt.addEventListener(bZ,function(b3){return y.Get(b2(b3),b0);},false);return this;},on:function(bZ,b0){this.elt.addEventListener(bZ,function(b1){return b0(b1.target,b1);},false);return this;}},be,bf);bf.TreeNode=function(bZ,b0){var b1,b2;function b3(b4){return b4[1];}b1=A.Create(b0);return new bf.New$1({$:6,$0:bZ},y.Map2Unit((b2=by.map(function(b4){return _5.Updates(b3(b4));},bZ.Attrs),d.TreeReduce(y.Const(),y.Map2Unit,b2)),b1.v),by.get(bZ.Els,0),b1);};bf.New=function(bZ,b0,b1){var b2,b3;b2=bd.CreateElemNode(bZ,b0,b1.docNode);b3=A.Create(b1.updates);return new bf.New$1({$:1,$0:b2},y.Map2Unit(_5.Updates(b2.Attr),b3.v),bZ,b3);};bf.New$1=bG.Ctor(function(bZ,b0,b1,b2){be.New.call(this,bZ,b0);this.docNode$1=bZ;this.updates$1=b0;this.elt=b1;this.rvUpdates=b2;},bf);bg=_2.EltUpdater=bG.Class({RemoveAllUpdated:function(){this.treeNode.Holes=this.origHoles;this.holeUpdates.Set([]);},RemoveUpdated:function(bZ){var b0,b1;function b2(b3){return b3!==b1;}b0=bZ.docNode;b0!=null&&b0.$==1?(b1=b0.$0.ElKey,this.treeNode.Holes=by.filter(function(b3){return b3.ElKey!==b1;},this.treeNode.Holes),this.holeUpdates.Set(by.filter(function(b3){return b2(b3[0]);},this.holeUpdates.Get()))):bM.FailWith("DocUpdater.RemoveUpdated expects a single element node");},AddUpdated:function(bZ){var b0,b1,b2;b0=bZ.docNode;b0!=null&&b0.$==1?(b1=b0.$0,this.treeNode.Holes=this.treeNode.Holes.concat([b1]),b2=this.holeUpdates.Get(),b2.push([b1.ElKey,bZ.updates]),this.holeUpdates.Set(b2)):bM.FailWith("DocUpdater.AddUpdated expects a single element node");},ClearHoles:function(){this.origHoles=[];this.treeNode.Holes=[];this.holeUpdates.Set([]);},AddHole:function(bZ){this.origHoles.push(bZ);this.treeNode.Holes=this.treeNode.Holes.concat([bZ]);}},bf,bg);bg.New=bG.Ctor(function(bZ,b0,b1,b2,b3){var b4,b5,b6,b7;function b8(b9){return b9[1];}bf.New$1.call(this,{$:6,$0:bZ},y.Map2Unit(b0,(b4=b3.get_View(),y.BindInner((b5=function(b9){return by.map(b8,b9);},(b6=(b7=y.Const(),function(b9){return d.TreeReduce(b7,y.Map2Unit,b9);}),function(b9){return b6(b5(b9));})),b4))),b1,b2);this.treeNode=bZ;this.holeUpdates=b3;this.origHoles=this.treeNode.Holes;},bg);bh.$cctor=function(){bh.$cctor=a.ignore;bh.BatchUpdatesEnabled=true;bh.LoadedTemplates=new bP.New$5();bh.LocalTemplatesLoaded=false;bh.TextHoleRE="\\${([^}]+)}";};bi=c.Flow=bG.Class({get_Render:function(){return this.render;}},k,bi);bi.New=bG.Ctor(function(bZ){bi.New$1.call(this,function(b0){return function(b1){return x.Set(b0,bZ(b1));};});},bi);bi.New$1=bG.Ctor(function(bZ){this.render=bZ;},bi);bi.get_Do=function(){return new bj.New();};bi.Static=function(bZ){return new bi.New$1(function(b0){return function(b1){x.Set(b0,bZ);return b1();};});};bi.Define=function(bZ){return new bi.New(function(b0){return bZ(function(b1){b0(b1);});});};bi.Embed=function(bZ){var b0;b0=x.Create$1(be.Empty());((bZ.get_Render())(b0))(a.ignore);return be.EmbedView(b0.get_View());};bi.Return=function(bZ){return new bi.New$1(function(){return function(b0){return b0(bZ);};});};bi.Bind=function(bZ,b0){return new bi.New$1(function(b1){return function(b2){return((bZ.get_Render())(b1))(function(b3){((b0(b3).get_Render())(b1))(b2);});};});};bi.Map=function(bZ,b0){return new bi.New$1(function(b1){return function(b2){return((b0.get_Render())(b1))(function(b3){b2(bZ(b3));});};});};bj=c.FlowBuilder=bG.Class({ReturnFrom:a.id,Return:function(bZ){return bi.Return(bZ);},Bind:function(bZ,b0){return bi.Bind(bZ,b0);}},k,bj);bj.New=bG.Ctor(function(){},bj);bl=bk.attr=bG.Class({},k,bl);bl.New=bG.Ctor(function(){},bl);bm.InstallHash=function(bZ,b0){var b1;function b2(b5){return bW.Parse(b0,bX.FromHash(b5,{$:1,$0:true}));}function b3(){var b5,b6;b5=a.location.hash;b6=b2(b5);return b6==null?((function(b7){return function(b8){return b7("Failed to parse route: "+bY.toSafe(b8));};}(function(b7){bI.log(b7);}))(b5),bZ):b6.$0;}function b4(b5){if(!bH.Equals(b1.Get(),b5))b1.Set(b5);}b1=x.Create$1(b3());a.onpopstate=function(){return b4(b3());};a.onhashchange=function(){return b4(b3());};bT(a.document.body).click(function(b5){var b6,b7,b8,b9;b6=bT(b5.target).closest("a").toArray();return!bH.Equals(b6,null)&&b6.length===1?(b7=by.get(b6,0),b7.localName==="a"?(b8=b7.getAttribute("href"),!(b8==null)&&bA.StartsWith(b8,"#")?(b9=b2(b8),b9==null?null:(b4(b9.$0),b5.preventDefault())):null):null):null;});y.Sink(function(b5){var b6;if(!bH.Equals(b5,b3())){b6=bW.HashLink(b0,b5);a.history.pushState(null,null,b6);}},b1.get_View());return b1;};bm.Install=function(bZ,b0){var b1;function b2(b5){return bW.Parse(b0,b5);}function b3(){var b5,b6,b7;b5=a.location;b6=bX.FromUrl(b5.pathname+b5.search,null);b7=b2(b6);return b7==null?((function(b8){return function(b9){return b8("Failed to parse route: "+bY.toSafe(b9));};}(function(b8){bI.log(b8);}))(b6.ToLink()),bZ):b7.$0;}function b4(b5){if(!bH.Equals(b1.Get(),b5))b1.Set(b5);}b1=x.Create$1(b3());a.onpopstate=function(){return b4(b3());};bT(a.document.body).click(function(b5){var b6,b7,b8,b9;b6=bT(b5.target).closest("a").toArray();return!bH.Equals(b6,null)&&b6.length===1?(b7=by.get(b6,0),b7.localName==="a"?(b8=b7.getAttribute("href"),!(b8==null)?(b9=b2(bX.FromUrl(b8,null)),b9==null?null:(b4(b9.$0),b5.preventDefault())):null):null):null;});y.Sink(function(b5){var b6;if(!bH.Equals(b5,b3())){b6=bW.Link(b0,b5);a.history.pushState(null,null,b6);}},b1.get_View());return b1;};bn.Append=function(bZ,b0){return{$:0,$0:p.Append(bZ.$0,b0.$0),$1:bK.FoldBack(function(b1,b2,b3){return b3.Add(b1,b2);},bZ.$1,b0.$1)};};bn.FromList=function(bZ,b0){return{$:0,$0:p.FromArray(by.ofList(bZ)),$1:b0};};bn.ToList=function(bZ){return[bx.ofArray(p.ToArray(bZ.$0)),bZ.$1];};bn.SameHash=function(bZ,b0){return bn.NoHash(bZ)===bn.NoHash(b0);};bn.MakeHash=function(bZ){var b0,b1;b0=bZ.$1;b1=bA.concat("/",by.map(function(b2){return a.encodeURIComponent(b2);},p.ToArray(bZ.$0)));return b0.get_IsEmpty()?b1:b1+"?"+bA.concat("&",bE.map(function(b2){var b3;b3=bM.KeyValue(b2);return a.encodeURIComponent(b3[0])+"="+a.encodeURIComponent(b3[1]);},b0));};bn.ParseHash=function(bZ){var b0,b1,b2,b3;b0=bn.NoHash(bZ);b1=(b2=b0.indexOf("?"),b2===-1?[b0,""]:[bU.string(b0,null,{$:1,$0:b2-1}),bU.string(b0,{$:1,$0:b2+1},null)]);b3=b1[0];return{$:0,$0:p.FromArray(b3===""?[]:by.map(function(b4){return a.decodeURIComponent(b4);},bA.SplitChars(b3,["/"],0))),$1:bK.OfArray(by.map(function(b4){var b5;b5=b4.indexOf("=");return b5===-1?[a.decodeURIComponent(b4),""]:[a.decodeURIComponent(bU.string(b4,null,{$:1,$0:b5-1})),a.decodeURIComponent(bU.string(b4,{$:1,$0:b5+1},null))];},bA.SplitChars(b1[1],["&"],0)))};};bn.NoHash=function(bZ){return bA.StartsWith(bZ,"#")?bZ.substring(1):bZ;};bo.DoLink=function(bZ,b0){var b1;b1=bZ.Ser(b0);return bn.FromList(b1[0],b1[1]);};bo.DoRoute=function(bZ,b0){return bZ.Des(bn.ToList(b0));};bo.InstallMap=function(bZ){var b0;function b1(b5,b6){return bH.Equals(bZ.Ser(b5),bZ.Ser(b6));}function b2(){return bZ.Des(bn.ToList(bn.ParseHash(a.location.hash)));}function b3(b5){if(!b1(b0.Get(),b5))b0.Set(b5);}function b4(b5){return b3(b2());}b0=x.Create$1(b2());a.onpopstate=b4;a.onhashchange=b4;y.Sink(function(b5){var b6,b7;b6=bn.MakeHash((b7=bZ.Ser(b5),bn.FromList(b7[0],b7[1])));!bn.SameHash(a.location.hash,b6)?a.location.replace("#"+b6):void 0;},b0.get_View());return b0;};bp.Install=function(bZ){return bo.InstallMap(bZ);};bp.Create=function(bZ,b0){function b1(b2){return b2[0];}return{Des:function(b2){return b0(b1(b2));},Ser:function(b2){return[bZ(b2),new bL.New([])];}};};bp.CreateWithQuery=function(bZ,b0){return{Des:b0,Ser:bZ};};br.New=function(bZ,b0){return{Active:bZ,PosV:b0};};bs.New=function(bZ,b0,b1,b2){return{Active:bZ,Left:b0,Middle:b1,Right:b2};};bt.get_MousePressed=function(){bq.ActivateButtonListener();return y.Apply(y.Apply(y.Apply(y.Const(bG.Curried3(function(bZ,b0,b1){return bZ||b0||b1;})),bq.MouseBtnSt$1().Left.get_View()),bq.MouseBtnSt$1().Middle.get_View()),bq.MouseBtnSt$1().Right.get_View());};bt.get_RightPressed=function(){bq.ActivateButtonListener();return bq.MouseBtnSt$1().Right.get_View();};bt.get_MiddlePressed=function(){bq.ActivateButtonListener();return bq.MouseBtnSt$1().Middle.get_View();};bt.get_LeftPressed=function(){bq.ActivateButtonListener();return bq.MouseBtnSt$1().Left.get_View();};bt.get_Position=function(){!bq.MousePosSt$1().Active?(a.document.addEventListener("mousemove",function(bZ){x.Set(bq.MousePosSt$1().PosV,[bZ.clientX,bZ.clientY]);},false),bq.MousePosSt$1().Active=true):void 0;return bq.MousePosSt$1().PosV.get_View();};bu.New=function(bZ,b0,b1){return{KeysPressed:bZ,KeyListenerActive:b0,LastPressed:b1};};bv.IsPressed=function(bZ){function b0(b1){return b1===bZ;}bq.ActivateKeyListener();return y.Map(function(b1){return bx.exists(b0,b1);},bq.KeyListenerState().KeysPressed.get_View());};bv.get_LastPressed=function(){bq.ActivateKeyListener();return bq.KeyListenerState().LastPressed.get_View();};bv.get_KeysPressed=function(){bq.ActivateKeyListener();return bq.KeyListenerState().KeysPressed.get_View();};bq.ActivateKeyListener=function(){bw.$cctor();return bw.ActivateKeyListener;};bq.KeyListenerState=function(){bw.$cctor();return bw.KeyListenerState;};bq.ActivateButtonListener=function(){bw.$cctor();return bw.ActivateButtonListener;};bq.MouseBtnSt$1=function(){bw.$cctor();return bw.MouseBtnSt;};bq.MousePosSt$1=function(){bw.$cctor();return bw.MousePosSt;};bw.$cctor=function(){bw.$cctor=a.ignore;function bZ(b0,b1){var b2;b2=b0.button;return b2===0?x.Set(bq.MouseBtnSt$1().Left,b1):b2===1?x.Set(bq.MouseBtnSt$1().Middle,b1):b2===2?x.Set(bq.MouseBtnSt$1().Right,b1):null;}bw.MousePosSt=br.New(false,x.Create$1([0,0]));bw.MouseBtnSt=bs.New(false,x.Create$1(false),x.Create$1(false),x.Create$1(false));bw.ActivateButtonListener=!bq.MouseBtnSt$1().Active?(bq.MouseBtnSt$1().Active=true,a.document.addEventListener("mousedown",function(b0){return bZ(b0,true);},false),a.document.addEventListener("mouseup",function(b0){return bZ(b0,false);},false)):null;bw.KeyListenerState=bu.New(x.Create$1(bx.T.Empty),false,x.Create$1(-1));bw.ActivateKeyListener=!bq.KeyListenerState().KeyListenerActive?(bT(a.document).keydown(function(b0){var b1,b2;b1=b0.which;x.Set(bq.KeyListenerState().LastPressed,b1);b2=bq.KeyListenerState().KeysPressed.Get();return!bx.exists(function(b3){return b3===b1;},b2)?bq.KeyListenerState().KeysPressed.Set(bx.append(b2,bx.ofArray([b1]))):null;}),void bT(a.document).keyup(function(b0){var b1;function b2(b3){return b3!==b1;}b1=b0.which;return x.Update(bq.KeyListenerState().KeysPressed,function(b3){return bx.filter(b2,b3);});})):null;};}());
